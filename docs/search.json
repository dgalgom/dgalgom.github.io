[
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this site\n\n1 + 1\n\n[1] 2"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "R/Medicine 2024 Data Challenge: Opioid Use Disorder",
    "section": "",
    "text": "Opioid use disorder (OUD) is defined as the chronic use of opioids that causes clinically significant distress or impairment. Symptoms of this disease include an overpowering desire to consume opioids, increased opioid tolerance, and withdrawal syndrome when opioids are discontinued (Leveille and Rambur 2024). OUD affects over 16 million people worldwide and over 2.1 million in the United States. While opioid painkillers prescriptions are becoming more closely regulated, cases of overdose and addiction are still increasing, especially among younger people. Thus, it is considered an important global health concern.\nIn this data analysis, we have tried to address how to optimize the treatments applied to alleviate OUD investigating their effectiveness against withdrawal symptoms, adherence, and pain.\n\n\n\nFirst, we are going to load the required libraries to conduct the analyses.\n\nlibrary(public.ctn0094data)\nlibrary(public.ctn0094extra)\nlibrary(dplyr) # data wrangling\nlibrary(tidyr) # data wrangling too\nlibrary(ggplot2) # data visualization\nlibrary(brms) # generalized linear modelling\nlibrary(mgcv) # generalized additive models for very large datasets\nlibrary(nnet) # for multinomial neural network algorithm\nlibrary(tidybayes) # data analysis and plotting\nlibrary(ggsci) # extra plot themes\nlibrary(tvthemes) # additional themes\nlibrary(marginaleffects) # counterfactual predictions and treatment effects \nlibrary(kableExtra) # table display\nlibrary(DT) # table display\nlibrary(plotly) # data visualization\n\nSecond, we are going to set up a dataset that gathers all important information (i.e., variables of interest) which could help us to understand latent patterns for which some treatments can be potentially more beneficial (i.e., reducing withdrawal symptoms, or increasing treatment adherence) for a specific sub-population within OUD patients. Our start point will be the everybody dataset, which contains all the participants with their corresponding identifiers (who), and the project they belonged.\n\neverybody %&gt;% \n  head() %&gt;% \n  kbl() %&gt;% \n  kable_styling(full_width = FALSE, \n                position = \"left\")\n\n\n\n\nwho\nproject\n\n\n\n\n8\n27\n\n\n10\n27\n\n\n11\n27\n\n\n12\n27\n\n\n13\n27\n\n\n14\n27\n\n\n\n\n\n\n\nTo predict what type of patients could benefit more from OUD treatments, we add demographic information to our dataset.\n\n# selecting the variables of interest based on evidence that could potentially predict outcomes of interest\nnew.demo &lt;- demographics %&gt;%\n  select(who, age, education, marital, is_male) %&gt;%\n  cbind(derived_raceEthnicity$race_ethnicity) # adding the self-reported race and ethnicity from the extra data\n\n# dataset\ndata &lt;- everybody %&gt;%\n  full_join(new.demo, by = \"who\") %&gt;%\n  rename(race = `derived_raceEthnicity$race_ethnicity`)\n\nOpioid addiction is rarely a stand-alone illness; frequently, people with opioid dependence are also struggling with a mental health condition. Therefore, psychiatric information can be useful to identify conditions that can be associated with OUDs.\n\n# selectig variables related to the Addiction Severity Index-Lite Follow-up scale for depression, anxiety and schizophrenia\nnew.psycho &lt;- psychiatric %&gt;%\n  select(who, depression, anxiety, schizophrenia)\n\n# combining datasets\ndata &lt;- data %&gt;%\n  full_join(new.psycho, by = \"who\") %&gt;%\n  arrange(who)\n\nNext, the time span for detox is included in our data. We checked out whether any patient had just one data point.\n\n# Checking data points\ndetox %&gt;% \n  group_by(who) %&gt;% \n  summarise(n = n()) %&gt;% \n  ungroup() %&gt;% \n  filter(!n == 2)\n## # A tibble: 0 × 2\n## # ℹ 2 variables: who &lt;int&gt;, n &lt;int&gt;\n## all participants had admission and discharge data points\n\n# Creating the new variable with the detox time span for each patient\nnew.detox &lt;- detox %&gt;% \n  mutate(what = factor(what, levels = c(\"admission\", \n                                                \"discharge\"))) %&gt;% # ensuring levels' names\n  arrange(what) %&gt;% # ensuring discharge time point - admission time point\n  group_by(who) %&gt;% \n  summarise(when = last(when) - first(when))\n\n# combining datasets\ndata &lt;- data %&gt;%\n  full_join(new.detox, by = \"who\") %&gt;%\n  arrange(who)\n\nIt could be interesting exploring the relationship between nicotine and opioid use and abuse. There are several pathways by which unique nicotine-opioid interactions may confer greater risk for prescription opioid misuse. First, chronic nicotine exposure may result in dysregulation of the endogenous opioid system, leading to greater pain and cross-tolerance to prescription opioids. It can be a red flag: a person who is consuming a lot of cigarettes (i.e., nicotine), and put into practice programs to prevent opioid misuse.\n\n# combining datasets\ndata &lt;- data %&gt;% \n  left_join(fagerstrom, by = \"who\")\n\nAlso, an interesting factor that can be associated to OUD is the quality of life (i.e., whether people are homeless or living in a shelter). This data is provided by the PhenX Quality of Life Survey.\n\n# combining datasets\ndata &lt;- data %&gt;% \n  left_join(qol, by = \"who\")\n\nThe adherence to the programmed sessions could be a key predictor for health outcomes like withdrawal symptoms. We are going to extract the days that participants attended the programmed sessions, and calculate the percentage of satisfied sessions. These numbers have to be taken carefully because a session categorized as Missing could be a session where participant was late.\n\n# calculate the adherence of participants to programmed sessions as percentage dividing the attended visits by the total number of programmed visits\nnew.visit &lt;- derived_visitImputed %&gt;%\n  group_by(who, visitImputed) %&gt;%\n  summarise(n = n()) %&gt;%\n  pivot_wider(names_from = visitImputed, values_from = n) %&gt;%\n  ungroup() %&gt;%\n  mutate(total = Missing + Present,\n         perc = Present / total) %&gt;%\n  select(who, perc)\n\n# combining datasets\ndata &lt;- data %&gt;% \n  full_join(new.visit, by = \"who\")\n\nNext, we are going to add the treatment that each participant received, and the day they started the assigned treatment.\n\n# removing duplicated IDs (we ensured that duplicated participants received all the same treatement); assumption: if inductDelay is NA, then we used the randomization day as the day which treatments started\nnew.random &lt;- randomization %&gt;% \n  filter(!duplicated(who)) %&gt;%\n  mutate(inductDelay = derived_inductDelay$inductDelay,\n         final.when = ifelse(inductDelay %in% NA, when, when + inductDelay)) %&gt;%\n  select(who, treatment, final.when)\n\n# combining datasets\ndata &lt;- data %&gt;%\n  full_join(new.random, by = \"who\")\n\nAlso, it is important to see how treatments are effective against pain, which is the principal cause for which opioids are prescribed. Therefore, we select the pain scores that were registered after treatment engagement to identify, if possible, what treatment was associated to lower levels of pain.\n\n# combining datasets\ndata &lt;- data %&gt;% \n  full_join(pain, by = \"who\") %&gt;% \n  \n  # variable creation indicating whether the day registered in the pain dataset is higher than the day of treatment involvement (when.y is the day that pain was registered)\n  mutate(validation = ifelse(when.y &gt; final.when, 1, 0))\n\n# when we analyze pain, we should filter the dataset by only the values == 1\n\nFinally, we also add the withdrawal symptoms, which can be a condition in this population really debilitating. It would be really useful and informative to investigate which treatment caused the greatest withdrawal symptoms reduction and for which people.\n\n# creating the new withdrawal dataset\nnew_withdrawal &lt;- withdrawal_pre_post %&gt;% \n  \n  # transforming the dataset to wide format\n  pivot_wider(names_from = what, values_from = c(withdrawal, when)) %&gt;% \n  \n  # days between pain assessments\n  mutate(duration_pre_post = when_post - when_pre) %&gt;%\n\n# ordering columns\n  select(who, withdrawal_pre, withdrawal_post, when_pre, when_post, duration_pre_post)\n\n# It would be interesting to consider whether the symptoms were assessed before or after the patient started to received its assigned treatment\n\n\n# combining datasets\ndata &lt;- data %&gt;%\n  full_join(new_withdrawal, by = \"who\")\n\nOur final dataset looks like this:\n\ndata %&gt;%\n  mutate(perc = round(perc, 3)) %&gt;%\n  head() %&gt;%\n  kbl() %&gt;%\n  kable_styling(position = \"left\")\n\n\n\n\nwho\nproject\nage\neducation\nmarital\nis_male\nrace\ndepression\nanxiety\nschizophrenia\nwhen.x\nis_smoker\nftnd\nper_day\nis_homeless\nperc\ntreatment\nfinal.when\npain\nwhen.y\nvalidation\nwithdrawal_pre\nwithdrawal_post\nwhen_pre\nwhen_post\nduration_pre_post\n\n\n\n\n1\n30\n43\nMore than HS\nMarried or Partnered\nYes\nNon-Hispanic White\nNo\nNo\nNo\nNA\nYes\n6\n11-20\nNA\nNA\nNA\nNA\nNo Pain\n7\nNA\nNA\nNA\nNA\nNA\nNA\n\n\n2\n30\n30\nMore than HS\nNever married\nNo\nNon-Hispanic White\nYes\nYes\nNo\nNA\nYes\n1\n11-20\nNA\n0.600\nOutpatient BUP + EMM\n7\nSevere Pain\n0\n0\n1\n0\nNA\nNA\nNA\n\n\n3\n51\n23\nMore than HS\nNever married\nNo\nNon-Hispanic Black\nYes\nYes\nNo\n5\nYes\n3\n10 OR LESS\nYes\n0.091\nInpatient BUP\n13\nVery mild to Moderate Pain\n7\n0\n3\nNA\n5\nNA\nNA\n\n\n4\n51\n19\nMore than HS\nNever married\nYes\nNon-Hispanic White\nYes\nYes\nNo\n5\nYes\n2\n10 OR LESS\nNo\n0.917\nInpatient NR-NTX\n1\nVery mild to Moderate Pain\n0\n0\n1\n1\n0\n7\n7\n\n\n5\n30\n31\nNA\nNA\nNo\nNon-Hispanic White\nMissing\nMissing\nMissing\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\n\n\n6\n30\n43\nHS/GED\nMarried or Partnered\nYes\nNon-Hispanic White\nNo\nNo\nNo\nNA\nYes\n4\n31 OR MORE\nNA\n0.133\nOutpatient BUP + SMM\n16\nVery mild to Moderate Pain\n9\n0\n2\n0\nNA\nNA\nNA\n\n\n\n\n\n\n\n\n\n\nOpioids are often prescribed by doctors as painkillers, as they can relieve pain by blocking the pain signals between the body and the brain. The most effective treatment to relieve pain in these patients remain unknown due to the poor study methodology, and lack of evidence relating to possible harms (Avery et al. 2022). Thus, it would be useful for healthcare professionals evidence on which treatment is associated with lower pain levels, and in which specific subpopulations.\n\n\n\n\n\n\nNote\n\n\n\nTo conduct this analysis, we first filtered by pain registers collected after treatment involvement trying to establish an association between treatment, and post-treatment levels. It would be very helpful in future studies to collect pre-treatment data to analyze between and inter-personal variability on pain levels in this population.\n\n\n\n\nIn this section, we performed a predictive model using a multinomial log-linear model to predict the responses on pain levels of patients after being treated adjusting by the symptomatology before receiving the treatment and other demographics characteristics such as age and race. Then, we compared several models’ fit to ensure we predict the responses using the most exact model.\n\n# ensuring replicability\nset.seed(19042023)\n\n# fitting multinomial models\n## model adjusting by treatment \nmodel &lt;- multinom(pain ~ treatment, data = data, trace = FALSE)\n\n## model adjusting by treatment and other covariates\nmodel.1 &lt;- multinom(pain ~ treatment + race + age + withdrawal_pre, data = data, trace = FALSE)\n\n\n\n\nNext, we are going to compare the fit of the performed models. We used two model fit parameters: the Akaike Information Criterion (AIC) and the deviance. Lower values in both parameters mean a better model fit. Differences in more than 5 points in the AIC is sufficient to rule out the model with the higher AIC value.\n\n## model fit comparison\ndata.frame(Models = c(\"Model (treatment)\",\n                      \"Model (treatment + more predictors)\"),\n           AIC = c(model$AIC, model.1$AIC),\n           Deviance = c(model$deviance, model.1$deviance)) %&gt;%\n  kbl()\n\n\n\n\nModels\nAIC\nDeviance\n\n\n\n\nModel (treatment)\n4414.45\n4378.45\n\n\nModel (treatment + more predictors)\n4333.22\n4255.22\n\n\n\n\n\n\n\nThe model with all predictors (i.e., the assigned treatment, the severity of withdrawal symptoms before the treatment, age, and the race) outperformed the simplest model. Therefore, we will use it to predict the probability of pain relief considering the treatment received, the severity of withdrawal symptoms before treatment, and the self-reported race adjusted by age.\n\n\n\n\n\n# plot\nmarginaleffects::predictions(model.1) %&gt;% \n  as.data.frame() %&gt;%\n  filter(group != \"Missing\") %&gt;%\n  mutate(group = factor(group, levels = c(\"No Pain\",\n                                          \"Very mild to Moderate Pain\",\n                                          \"Severe Pain\"))) %&gt;%\n  group_by(treatment, withdrawal_pre, race, group) %&gt;%\n  mean_qi(estimate) %&gt;%\n  as.data.frame() %&gt;%\n  mutate(treatment = reorder(treatment, estimate)) %&gt;%\n  ggplot(aes(x = withdrawal_pre, y = .lower)) +\n  geom_pointinterval(aes(ymin = .lower, \n                         ymax = .upper, \n                         col = treatment),\n                     position = position_dodge(width = 0.5)) +\n  facet_grid(race ~ group, \n             scales = \"free\") +\n  labs(col = \"Treatment\",\n       x = \"Withdrawal symptoms before treatment\",\n       y = \"Probability of experimenting a specific pain level\") +\n  theme_dark() +\n  scale_color_viridis_d(option = \"H\") +\n  scale_y_continuous(limits = 0:1, \n                     breaks = seq(0, 1, 0.25)) +\n  scale_x_discrete(labels = c(\"None\",\n                              \"Mild \",\n                              \"Moderate\",\n                              \"Severe\")) +\n  theme(legend.position = \"bottom\",\n        legend.box = \"vertical\",\n        strip.text = element_text(size = 9))\n\n\n\n\n(a) Notes. BUP: Buprenorphine; NR-NTX: Extended-release Naltrexone; SMM: Standard Medical Management; EMM: Enhanced Medical Management (SMM + Indivdual Drug Counselling).\n\n\n\nFigure 1: Predictions for pain levels adjusted by race, age, and withdrawal symptoms before treatment involvement.\n\n\nWe can observe that naltrexone and buprenorphine administered to institutionalized patients showed the highest probability of total pain relief in all subpopulations regardless withdrawal symptoms before starting the treatment (Figure 1). Interestingly, more severe withdrawal symptoms before treatment involvement were associated with lower probabilities of pain relief; therefore, detox treatments for these patients are key for reducing opioid withdrawal symptoms, and potentially, achieve a complete pain relief. Although lack of rigorous evidence, a rapid review showed evidence supporting the practice of continuing methadone or buprenorphine for patients taking medication for OUD during acute pain episodes (Veazie et al. 2020). Furthermore, a clinical guideline for treating pain in patients with OUD by the Commonwealth of Pennsylvania also supports the use of buprenorphine for managing acute pain in OUD patients, indicating that there are data suggesting better performing of buprenorphine when compared to methadone, for example (Compton, Charuvastra, and Ling 2001). Evidence on naltrexone suggests that the extended-release (i.e., injectable) option is the preferred one for patients who would like to avoid taking any form of opioid or for whom buprenorphine or methadone are contraindicated (Connery 2015). Table 1 displays all numerical data.\n\n# table\nmarginaleffects::predictions(model.1) %&gt;% \n  as.data.frame() %&gt;%\n  filter(group != \"Missing\") %&gt;%\n  mutate(group = factor(group, levels = c(\"No Pain\",\n                                          \"Very mild to Moderate Pain\",\n                                          \"Severe Pain\"))) %&gt;%\n  mutate(withdrawal_pre = case_when(\n    withdrawal_pre == \"0\" ~ \"None\",\n    withdrawal_pre == \"1\" ~ \"Mild\",\n    withdrawal_pre == \"2\" ~ \"Moderate\",\n    withdrawal_pre == \"3\" ~ \"Severe\"\n  ),\n  withdrawal_pre = factor(withdrawal_pre, levels = c(\"None\",\n                                                     \"Mild\",\n                                                     \"Moderate\",\n                                                     \"Severe\"))) %&gt;%\n  group_by(treatment, withdrawal_pre, race, group) %&gt;%\n  mean_qi(estimate) %&gt;%\n  as.data.frame() %&gt;%\n  mutate(treatment = reorder(treatment, estimate)) %&gt;%\n  select(treatment, withdrawal_pre,\n         race, group, estimate,\n         .lower, .upper) %&gt;%\n  rename(Treatment = treatment,\n         `Symptoms before treatment` = withdrawal_pre,\n         Race = race,\n         `Pain level\\nafter treatment` = group,\n         Probability = estimate,\n         `95% lower bound` = .lower,\n         `95% upper bound` = .upper) %&gt;%\n  mutate_if(is.numeric, round, 3) %&gt;%\n  kbl()\n\n\nTable 1: Table 1. Predicted probabilities of pain level after treatment.\n\n\n\n\n(a) Notes. 95% CI corresponds to the 95% confidence interval of the predicted probability.\n\n\nTreatment\nSymptoms before treatment\nRace\nPain level after treatment\nProbability\n95% lower bound\n95% upper bound\n\n\n\n\nInpatient BUP\nNone\nNon-Hispanic White\nNo Pain\n0.759\n0.706\n0.791\n\n\nInpatient BUP\nNone\nNon-Hispanic White\nVery mild to Moderate Pain\n0.214\n0.187\n0.258\n\n\nInpatient BUP\nNone\nNon-Hispanic White\nSevere Pain\n0.027\n0.022\n0.036\n\n\nInpatient BUP\nNone\nNon-Hispanic Black\nNo Pain\n0.766\n0.766\n0.766\n\n\nInpatient BUP\nNone\nNon-Hispanic Black\nVery mild to Moderate Pain\n0.206\n0.206\n0.206\n\n\nInpatient BUP\nNone\nNon-Hispanic Black\nSevere Pain\n0.028\n0.028\n0.028\n\n\nInpatient BUP\nNone\nHispanic\nNo Pain\n0.806\n0.731\n0.846\n\n\nInpatient BUP\nNone\nHispanic\nVery mild to Moderate Pain\n0.165\n0.133\n0.223\n\n\nInpatient BUP\nNone\nHispanic\nSevere Pain\n0.029\n0.021\n0.046\n\n\nInpatient BUP\nMild\nNon-Hispanic White\nNo Pain\n0.481\n0.383\n0.536\n\n\nInpatient BUP\nMild\nNon-Hispanic White\nVery mild to Moderate Pain\n0.496\n0.445\n0.585\n\n\nInpatient BUP\nMild\nNon-Hispanic White\nSevere Pain\n0.023\n0.018\n0.031\n\n\nInpatient BUP\nMild\nNon-Hispanic Black\nNo Pain\n0.540\n0.467\n0.621\n\n\nInpatient BUP\nMild\nNon-Hispanic Black\nVery mild to Moderate Pain\n0.439\n0.365\n0.506\n\n\nInpatient BUP\nMild\nNon-Hispanic Black\nSevere Pain\n0.020\n0.015\n0.026\n\n\nInpatient BUP\nMild\nHispanic\nNo Pain\n0.579\n0.517\n0.627\n\n\nInpatient BUP\nMild\nHispanic\nVery mild to Moderate Pain\n0.396\n0.353\n0.452\n\n\nInpatient BUP\nMild\nHispanic\nSevere Pain\n0.024\n0.020\n0.031\n\n\nInpatient BUP\nMild\nOther\nNo Pain\n0.439\n0.380\n0.479\n\n\nInpatient BUP\nMild\nOther\nVery mild to Moderate Pain\n0.527\n0.491\n0.579\n\n\nInpatient BUP\nMild\nOther\nSevere Pain\n0.034\n0.029\n0.041\n\n\nInpatient BUP\nModerate\nNon-Hispanic White\nNo Pain\n0.392\n0.304\n0.437\n\n\nInpatient BUP\nModerate\nNon-Hispanic White\nVery mild to Moderate Pain\n0.580\n0.539\n0.658\n\n\nInpatient BUP\nModerate\nNon-Hispanic White\nSevere Pain\n0.029\n0.024\n0.038\n\n\nInpatient BUP\nModerate\nNon-Hispanic Black\nNo Pain\n0.433\n0.363\n0.499\n\n\nInpatient BUP\nModerate\nNon-Hispanic Black\nVery mild to Moderate Pain\n0.539\n0.479\n0.603\n\n\nInpatient BUP\nModerate\nNon-Hispanic Black\nSevere Pain\n0.028\n0.022\n0.035\n\n\nInpatient BUP\nModerate\nHispanic\nNo Pain\n0.500\n0.446\n0.525\n\n\nInpatient BUP\nModerate\nHispanic\nVery mild to Moderate Pain\n0.470\n0.448\n0.517\n\n\nInpatient BUP\nModerate\nHispanic\nSevere Pain\n0.031\n0.028\n0.037\n\n\nInpatient BUP\nModerate\nOther\nNo Pain\n0.322\n0.282\n0.363\n\n\nInpatient BUP\nModerate\nOther\nVery mild to Moderate Pain\n0.632\n0.597\n0.666\n\n\nInpatient BUP\nModerate\nOther\nSevere Pain\n0.046\n0.040\n0.053\n\n\nInpatient BUP\nSevere\nNon-Hispanic White\nNo Pain\n0.185\n0.143\n0.215\n\n\nInpatient BUP\nSevere\nNon-Hispanic White\nVery mild to Moderate Pain\n0.728\n0.707\n0.756\n\n\nInpatient BUP\nSevere\nNon-Hispanic White\nSevere Pain\n0.087\n0.078\n0.102\n\n\nInpatient BUP\nSevere\nNon-Hispanic Black\nNo Pain\n0.254\n0.211\n0.293\n\n\nInpatient BUP\nSevere\nNon-Hispanic Black\nVery mild to Moderate Pain\n0.670\n0.641\n0.702\n\n\nInpatient BUP\nSevere\nNon-Hispanic Black\nSevere Pain\n0.076\n0.067\n0.087\n\n\nInpatient BUP\nSevere\nHispanic\nNo Pain\n0.247\n0.176\n0.289\n\n\nInpatient BUP\nSevere\nHispanic\nVery mild to Moderate Pain\n0.648\n0.620\n0.693\n\n\nInpatient BUP\nSevere\nHispanic\nSevere Pain\n0.105\n0.091\n0.131\n\n\nInpatient BUP\nSevere\nOther\nNo Pain\n0.153\n0.144\n0.157\n\n\nInpatient BUP\nSevere\nOther\nVery mild to Moderate Pain\n0.724\n0.722\n0.729\n\n\nInpatient BUP\nSevere\nOther\nSevere Pain\n0.123\n0.121\n0.127\n\n\nInpatient NR-NTX\nNone\nNon-Hispanic White\nNo Pain\n0.779\n0.733\n0.800\n\n\nInpatient NR-NTX\nNone\nNon-Hispanic White\nVery mild to Moderate Pain\n0.195\n0.178\n0.233\n\n\nInpatient NR-NTX\nNone\nNon-Hispanic White\nSevere Pain\n0.026\n0.022\n0.034\n\n\nInpatient NR-NTX\nNone\nNon-Hispanic Black\nNo Pain\n0.807\n0.788\n0.818\n\n\nInpatient NR-NTX\nNone\nNon-Hispanic Black\nVery mild to Moderate Pain\n0.169\n0.161\n0.186\n\n\nInpatient NR-NTX\nNone\nNon-Hispanic Black\nSevere Pain\n0.023\n0.021\n0.027\n\n\nInpatient NR-NTX\nNone\nHispanic\nNo Pain\n0.828\n0.798\n0.855\n\n\nInpatient NR-NTX\nNone\nHispanic\nVery mild to Moderate Pain\n0.146\n0.124\n0.169\n\n\nInpatient NR-NTX\nNone\nHispanic\nSevere Pain\n0.027\n0.021\n0.033\n\n\nInpatient NR-NTX\nMild\nNon-Hispanic White\nNo Pain\n0.513\n0.408\n0.563\n\n\nInpatient NR-NTX\nMild\nNon-Hispanic White\nVery mild to Moderate Pain\n0.465\n0.419\n0.561\n\n\nInpatient NR-NTX\nMild\nNon-Hispanic White\nSevere Pain\n0.022\n0.018\n0.032\n\n\nInpatient NR-NTX\nMild\nNon-Hispanic Black\nNo Pain\n0.574\n0.501\n0.632\n\n\nInpatient NR-NTX\nMild\nNon-Hispanic Black\nVery mild to Moderate Pain\n0.407\n0.353\n0.474\n\n\nInpatient NR-NTX\nMild\nNon-Hispanic Black\nSevere Pain\n0.020\n0.015\n0.026\n\n\nInpatient NR-NTX\nMild\nHispanic\nNo Pain\n0.599\n0.510\n0.657\n\n\nInpatient NR-NTX\nMild\nHispanic\nVery mild to Moderate Pain\n0.376\n0.324\n0.456\n\n\nInpatient NR-NTX\nMild\nHispanic\nSevere Pain\n0.025\n0.019\n0.034\n\n\nInpatient NR-NTX\nMild\nOther\nNo Pain\n0.447\n0.367\n0.478\n\n\nInpatient NR-NTX\nMild\nOther\nVery mild to Moderate Pain\n0.517\n0.490\n0.586\n\n\nInpatient NR-NTX\nMild\nOther\nSevere Pain\n0.036\n0.032\n0.047\n\n\nInpatient NR-NTX\nModerate\nNon-Hispanic White\nNo Pain\n0.423\n0.357\n0.462\n\n\nInpatient NR-NTX\nModerate\nNon-Hispanic White\nVery mild to Moderate Pain\n0.549\n0.513\n0.608\n\n\nInpatient NR-NTX\nModerate\nNon-Hispanic White\nSevere Pain\n0.028\n0.025\n0.035\n\n\nInpatient NR-NTX\nModerate\nNon-Hispanic Black\nNo Pain\n0.502\n0.428\n0.533\n\n\nInpatient NR-NTX\nModerate\nNon-Hispanic Black\nVery mild to Moderate Pain\n0.474\n0.446\n0.541\n\n\nInpatient NR-NTX\nModerate\nNon-Hispanic Black\nSevere Pain\n0.024\n0.021\n0.031\n\n\nInpatient NR-NTX\nModerate\nHispanic\nNo Pain\n0.520\n0.481\n0.562\n\n\nInpatient NR-NTX\nModerate\nHispanic\nVery mild to Moderate Pain\n0.449\n0.411\n0.483\n\n\nInpatient NR-NTX\nModerate\nHispanic\nSevere Pain\n0.031\n0.026\n0.035\n\n\nInpatient NR-NTX\nModerate\nOther\nNo Pain\n0.352\n0.286\n0.389\n\n\nInpatient NR-NTX\nModerate\nOther\nVery mild to Moderate Pain\n0.602\n0.571\n0.658\n\n\nInpatient NR-NTX\nModerate\nOther\nSevere Pain\n0.046\n0.041\n0.057\n\n\nInpatient NR-NTX\nSevere\nNon-Hispanic White\nNo Pain\n0.203\n0.150\n0.245\n\n\nInpatient NR-NTX\nSevere\nNon-Hispanic White\nVery mild to Moderate Pain\n0.708\n0.678\n0.743\n\n\nInpatient NR-NTX\nSevere\nNon-Hispanic White\nSevere Pain\n0.089\n0.077\n0.107\n\n\nInpatient NR-NTX\nSevere\nNon-Hispanic Black\nNo Pain\n0.221\n0.169\n0.289\n\n\nInpatient NR-NTX\nSevere\nNon-Hispanic Black\nVery mild to Moderate Pain\n0.687\n0.638\n0.722\n\n\nInpatient NR-NTX\nSevere\nNon-Hispanic Black\nSevere Pain\n0.093\n0.074\n0.110\n\n\nInpatient NR-NTX\nSevere\nHispanic\nNo Pain\n0.259\n0.200\n0.298\n\n\nInpatient NR-NTX\nSevere\nHispanic\nVery mild to Moderate Pain\n0.632\n0.606\n0.669\n\n\nInpatient NR-NTX\nSevere\nHispanic\nSevere Pain\n0.109\n0.096\n0.131\n\n\nInpatient NR-NTX\nSevere\nOther\nNo Pain\n0.168\n0.139\n0.184\n\n\nInpatient NR-NTX\nSevere\nOther\nVery mild to Moderate Pain\n0.706\n0.697\n0.721\n\n\nInpatient NR-NTX\nSevere\nOther\nSevere Pain\n0.126\n0.119\n0.140\n\n\nMethadone\nNone\nNon-Hispanic White\nNo Pain\n0.398\n0.325\n0.433\n\n\nMethadone\nNone\nNon-Hispanic White\nVery mild to Moderate Pain\n0.385\n0.370\n0.414\n\n\nMethadone\nNone\nNon-Hispanic White\nSevere Pain\n0.217\n0.197\n0.261\n\n\nMethadone\nNone\nNon-Hispanic Black\nNo Pain\n0.377\n0.359\n0.395\n\n\nMethadone\nNone\nNon-Hispanic Black\nVery mild to Moderate Pain\n0.380\n0.373\n0.387\n\n\nMethadone\nNone\nNon-Hispanic Black\nSevere Pain\n0.243\n0.231\n0.254\n\n\nMethadone\nNone\nHispanic\nNo Pain\n0.371\n0.366\n0.376\n\n\nMethadone\nNone\nHispanic\nVery mild to Moderate Pain\n0.336\n0.335\n0.338\n\n\nMethadone\nNone\nHispanic\nSevere Pain\n0.293\n0.289\n0.296\n\n\nMethadone\nNone\nOther\nNo Pain\n0.302\n0.281\n0.323\n\n\nMethadone\nNone\nOther\nVery mild to Moderate Pain\n0.381\n0.376\n0.387\n\n\nMethadone\nNone\nOther\nSevere Pain\n0.316\n0.301\n0.332\n\n\nMethadone\nMild\nNon-Hispanic White\nNo Pain\n0.167\n0.118\n0.205\n\n\nMethadone\nMild\nNon-Hispanic White\nVery mild to Moderate Pain\n0.675\n0.661\n0.686\n\n\nMethadone\nMild\nNon-Hispanic White\nSevere Pain\n0.147\n0.129\n0.172\n\n\nMethadone\nMild\nNon-Hispanic Black\nNo Pain\n0.179\n0.144\n0.251\n\n\nMethadone\nMild\nNon-Hispanic Black\nVery mild to Moderate Pain\n0.642\n0.618\n0.646\n\n\nMethadone\nMild\nNon-Hispanic Black\nSevere Pain\n0.148\n0.121\n0.162\n\n\nMethadone\nMild\nHispanic\nNo Pain\n0.205\n0.163\n0.272\n\n\nMethadone\nMild\nHispanic\nVery mild to Moderate Pain\n0.600\n0.574\n0.612\n\n\nMethadone\nMild\nHispanic\nSevere Pain\n0.182\n0.150\n0.204\n\n\nMethadone\nMild\nOther\nNo Pain\n0.119\n0.077\n0.159\n\n\nMethadone\nMild\nOther\nVery mild to Moderate Pain\n0.648\n0.632\n0.654\n\n\nMethadone\nMild\nOther\nSevere Pain\n0.213\n0.186\n0.243\n\n\nMethadone\nModerate\nNon-Hispanic White\nNo Pain\n0.117\n0.084\n0.146\n\n\nMethadone\nModerate\nNon-Hispanic White\nVery mild to Moderate Pain\n0.706\n0.700\n0.709\n\n\nMethadone\nModerate\nNon-Hispanic White\nSevere Pain\n0.168\n0.150\n0.191\n\n\nMethadone\nModerate\nNon-Hispanic Black\nNo Pain\n0.131\n0.100\n0.179\n\n\nMethadone\nModerate\nNon-Hispanic Black\nVery mild to Moderate Pain\n0.675\n0.668\n0.679\n\n\nMethadone\nModerate\nNon-Hispanic Black\nSevere Pain\n0.169\n0.144\n0.186\n\n\nMethadone\nModerate\nHispanic\nNo Pain\n0.147\n0.110\n0.186\n\n\nMethadone\nModerate\nHispanic\nVery mild to Moderate Pain\n0.634\n0.625\n0.637\n\n\nMethadone\nModerate\nHispanic\nSevere Pain\n0.209\n0.185\n0.235\n\n\nMethadone\nModerate\nOther\nNo Pain\n0.087\n0.066\n0.109\n\n\nMethadone\nModerate\nOther\nVery mild to Moderate Pain\n0.668\n0.658\n0.673\n\n\nMethadone\nModerate\nOther\nSevere Pain\n0.232\n0.212\n0.254\n\n\nMethadone\nSevere\nNon-Hispanic White\nNo Pain\n0.040\n0.027\n0.050\n\n\nMethadone\nSevere\nNon-Hispanic White\nVery mild to Moderate Pain\n0.613\n0.590\n0.626\n\n\nMethadone\nSevere\nNon-Hispanic White\nSevere Pain\n0.347\n0.324\n0.382\n\n\nMethadone\nSevere\nHispanic\nNo Pain\n0.053\n0.040\n0.063\n\n\nMethadone\nSevere\nHispanic\nVery mild to Moderate Pain\n0.538\n0.523\n0.549\n\n\nMethadone\nSevere\nHispanic\nSevere Pain\n0.410\n0.388\n0.437\n\n\nMethadone\nSevere\nOther\nNo Pain\n0.031\n0.031\n0.031\n\n\nMethadone\nSevere\nOther\nVery mild to Moderate Pain\n0.543\n0.543\n0.543\n\n\nMethadone\nSevere\nOther\nSevere Pain\n0.426\n0.426\n0.426\n\n\nOutpatient BUP\nNone\nNon-Hispanic White\nNo Pain\n0.361\n0.336\n0.389\n\n\nOutpatient BUP\nNone\nNon-Hispanic White\nVery mild to Moderate Pain\n0.407\n0.396\n0.417\n\n\nOutpatient BUP\nNone\nNon-Hispanic White\nSevere Pain\n0.232\n0.215\n0.246\n\n\nOutpatient BUP\nNone\nNon-Hispanic Black\nNo Pain\n0.425\n0.425\n0.425\n\n\nOutpatient BUP\nNone\nNon-Hispanic Black\nVery mild to Moderate Pain\n0.367\n0.367\n0.367\n\n\nOutpatient BUP\nNone\nNon-Hispanic Black\nSevere Pain\n0.208\n0.208\n0.208\n\n\nOutpatient BUP\nNone\nHispanic\nNo Pain\n0.441\n0.385\n0.484\n\n\nOutpatient BUP\nNone\nHispanic\nVery mild to Moderate Pain\n0.319\n0.302\n0.339\n\n\nOutpatient BUP\nNone\nHispanic\nSevere Pain\n0.241\n0.214\n0.276\n\n\nOutpatient BUP\nMild\nNon-Hispanic White\nNo Pain\n0.173\n0.119\n0.211\n\n\nOutpatient BUP\nMild\nNon-Hispanic White\nVery mild to Moderate Pain\n0.680\n0.664\n0.695\n\n\nOutpatient BUP\nMild\nNon-Hispanic White\nSevere Pain\n0.139\n0.122\n0.166\n\n\nOutpatient BUP\nMild\nNon-Hispanic Black\nNo Pain\n0.187\n0.144\n0.272\n\n\nOutpatient BUP\nMild\nNon-Hispanic Black\nVery mild to Moderate Pain\n0.648\n0.612\n0.656\n\n\nOutpatient BUP\nMild\nNon-Hispanic Black\nSevere Pain\n0.141\n0.110\n0.157\n\n\nOutpatient BUP\nMild\nHispanic\nNo Pain\n0.204\n0.153\n0.273\n\n\nOutpatient BUP\nMild\nHispanic\nVery mild to Moderate Pain\n0.608\n0.579\n0.621\n\n\nOutpatient BUP\nMild\nHispanic\nSevere Pain\n0.177\n0.144\n0.204\n\n\nOutpatient BUP\nMild\nOther\nNo Pain\n0.132\n0.093\n0.168\n\n\nOutpatient BUP\nMild\nOther\nVery mild to Moderate Pain\n0.659\n0.652\n0.662\n\n\nOutpatient BUP\nMild\nOther\nSevere Pain\n0.197\n0.174\n0.224\n\n\nOutpatient BUP\nModerate\nNon-Hispanic White\nNo Pain\n0.119\n0.080\n0.152\n\n\nOutpatient BUP\nModerate\nNon-Hispanic White\nVery mild to Moderate Pain\n0.713\n0.704\n0.717\n\n\nOutpatient BUP\nModerate\nNon-Hispanic White\nSevere Pain\n0.161\n0.141\n0.189\n\n\nOutpatient BUP\nModerate\nNon-Hispanic Black\nNo Pain\n0.136\n0.111\n0.181\n\n\nOutpatient BUP\nModerate\nNon-Hispanic Black\nVery mild to Moderate Pain\n0.686\n0.674\n0.688\n\n\nOutpatient BUP\nModerate\nNon-Hispanic Black\nSevere Pain\n0.160\n0.138\n0.174\n\n\nOutpatient BUP\nModerate\nHispanic\nNo Pain\n0.152\n0.114\n0.196\n\n\nOutpatient BUP\nModerate\nHispanic\nVery mild to Moderate Pain\n0.641\n0.628\n0.646\n\n\nOutpatient BUP\nModerate\nHispanic\nSevere Pain\n0.199\n0.172\n0.225\n\n\nOutpatient BUP\nModerate\nOther\nNo Pain\n0.087\n0.061\n0.107\n\n\nOutpatient BUP\nModerate\nOther\nVery mild to Moderate Pain\n0.677\n0.664\n0.681\n\n\nOutpatient BUP\nModerate\nOther\nSevere Pain\n0.225\n0.206\n0.252\n\n\nOutpatient BUP\nSevere\nNon-Hispanic White\nNo Pain\n0.044\n0.033\n0.055\n\n\nOutpatient BUP\nSevere\nNon-Hispanic White\nVery mild to Moderate Pain\n0.628\n0.612\n0.640\n\n\nOutpatient BUP\nSevere\nNon-Hispanic White\nSevere Pain\n0.328\n0.305\n0.355\n\n\nOutpatient BUP\nSevere\nHispanic\nNo Pain\n0.049\n0.049\n0.049\n\n\nOutpatient BUP\nSevere\nHispanic\nVery mild to Moderate Pain\n0.545\n0.545\n0.545\n\n\nOutpatient BUP\nSevere\nHispanic\nSevere Pain\n0.405\n0.405\n0.405\n\n\nOutpatient BUP\nSevere\nOther\nNo Pain\n0.034\n0.034\n0.034\n\n\nOutpatient BUP\nSevere\nOther\nVery mild to Moderate Pain\n0.560\n0.560\n0.560\n\n\nOutpatient BUP\nSevere\nOther\nSevere Pain\n0.405\n0.405\n0.405\n\n\nOutpatient BUP + EMM\nMild\nNon-Hispanic White\nNo Pain\n0.212\n0.149\n0.257\n\n\nOutpatient BUP + EMM\nMild\nNon-Hispanic White\nVery mild to Moderate Pain\n0.639\n0.615\n0.669\n\n\nOutpatient BUP + EMM\nMild\nNon-Hispanic White\nSevere Pain\n0.148\n0.128\n0.182\n\n\nOutpatient BUP + EMM\nMild\nNon-Hispanic Black\nNo Pain\n0.253\n0.213\n0.287\n\n\nOutpatient BUP + EMM\nMild\nNon-Hispanic Black\nVery mild to Moderate Pain\n0.605\n0.586\n0.627\n\n\nOutpatient BUP + EMM\nMild\nNon-Hispanic Black\nSevere Pain\n0.142\n0.128\n0.160\n\n\nOutpatient BUP + EMM\nMild\nHispanic\nNo Pain\n0.287\n0.230\n0.333\n\n\nOutpatient BUP + EMM\nMild\nHispanic\nVery mild to Moderate Pain\n0.546\n0.522\n0.575\n\n\nOutpatient BUP + EMM\nMild\nHispanic\nSevere Pain\n0.167\n0.146\n0.195\n\n\nOutpatient BUP + EMM\nMild\nOther\nNo Pain\n0.179\n0.142\n0.196\n\n\nOutpatient BUP + EMM\nMild\nOther\nVery mild to Moderate Pain\n0.620\n0.615\n0.632\n\n\nOutpatient BUP + EMM\nMild\nOther\nSevere Pain\n0.201\n0.190\n0.226\n\n\nOutpatient BUP + EMM\nModerate\nNon-Hispanic White\nNo Pain\n0.155\n0.107\n0.187\n\n\nOutpatient BUP + EMM\nModerate\nNon-Hispanic White\nVery mild to Moderate Pain\n0.676\n0.662\n0.691\n\n\nOutpatient BUP + EMM\nModerate\nNon-Hispanic White\nSevere Pain\n0.169\n0.150\n0.203\n\n\nOutpatient BUP + EMM\nModerate\nNon-Hispanic Black\nNo Pain\n0.184\n0.156\n0.213\n\n\nOutpatient BUP + EMM\nModerate\nNon-Hispanic Black\nVery mild to Moderate Pain\n0.650\n0.636\n0.662\n\n\nOutpatient BUP + EMM\nModerate\nNon-Hispanic Black\nSevere Pain\n0.167\n0.151\n0.182\n\n\nOutpatient BUP + EMM\nModerate\nHispanic\nNo Pain\n0.200\n0.154\n0.230\n\n\nOutpatient BUP + EMM\nModerate\nHispanic\nVery mild to Moderate Pain\n0.596\n0.585\n0.612\n\n\nOutpatient BUP + EMM\nModerate\nHispanic\nSevere Pain\n0.204\n0.185\n0.234\n\n\nOutpatient BUP + EMM\nModerate\nOther\nNo Pain\n0.107\n0.095\n0.118\n\n\nOutpatient BUP + EMM\nModerate\nOther\nVery mild to Moderate Pain\n0.648\n0.648\n0.648\n\n\nOutpatient BUP + EMM\nModerate\nOther\nSevere Pain\n0.245\n0.234\n0.256\n\n\nOutpatient BUP + EMM\nSevere\nNon-Hispanic White\nNo Pain\n0.056\n0.045\n0.063\n\n\nOutpatient BUP + EMM\nSevere\nNon-Hispanic White\nVery mild to Moderate Pain\n0.596\n0.585\n0.603\n\n\nOutpatient BUP + EMM\nSevere\nNon-Hispanic White\nSevere Pain\n0.348\n0.334\n0.371\n\n\nOutpatient BUP + SMM\nNone\nNon-Hispanic White\nNo Pain\n0.488\n0.488\n0.488\n\n\nOutpatient BUP + SMM\nNone\nNon-Hispanic White\nVery mild to Moderate Pain\n0.334\n0.334\n0.334\n\n\nOutpatient BUP + SMM\nNone\nNon-Hispanic White\nSevere Pain\n0.178\n0.178\n0.178\n\n\nOutpatient BUP + SMM\nNone\nHispanic\nNo Pain\n0.530\n0.530\n0.530\n\n\nOutpatient BUP + SMM\nNone\nHispanic\nVery mild to Moderate Pain\n0.269\n0.269\n0.269\n\n\nOutpatient BUP + SMM\nNone\nHispanic\nSevere Pain\n0.202\n0.202\n0.202\n\n\nOutpatient BUP + SMM\nMild\nNon-Hispanic White\nNo Pain\n0.205\n0.148\n0.251\n\n\nOutpatient BUP + SMM\nMild\nNon-Hispanic White\nVery mild to Moderate Pain\n0.653\n0.627\n0.681\n\n\nOutpatient BUP + SMM\nMild\nNon-Hispanic White\nSevere Pain\n0.142\n0.122\n0.171\n\n\nOutpatient BUP + SMM\nMild\nNon-Hispanic Black\nNo Pain\n0.260\n0.212\n0.304\n\n\nOutpatient BUP + SMM\nMild\nNon-Hispanic Black\nVery mild to Moderate Pain\n0.610\n0.583\n0.638\n\n\nOutpatient BUP + SMM\nMild\nNon-Hispanic Black\nSevere Pain\n0.130\n0.113\n0.150\n\n\nOutpatient BUP + SMM\nMild\nHispanic\nNo Pain\n0.258\n0.187\n0.310\n\n\nOutpatient BUP + SMM\nMild\nHispanic\nVery mild to Moderate Pain\n0.571\n0.544\n0.604\n\n\nOutpatient BUP + SMM\nMild\nHispanic\nSevere Pain\n0.171\n0.146\n0.209\n\n\nOutpatient BUP + SMM\nMild\nOther\nNo Pain\n0.169\n0.157\n0.193\n\n\nOutpatient BUP + SMM\nMild\nOther\nVery mild to Moderate Pain\n0.637\n0.627\n0.641\n\n\nOutpatient BUP + SMM\nMild\nOther\nSevere Pain\n0.195\n0.180\n0.202\n\n\nOutpatient BUP + SMM\nModerate\nNon-Hispanic White\nNo Pain\n0.150\n0.105\n0.179\n\n\nOutpatient BUP + SMM\nModerate\nNon-Hispanic White\nVery mild to Moderate Pain\n0.689\n0.677\n0.704\n\n\nOutpatient BUP + SMM\nModerate\nNon-Hispanic White\nSevere Pain\n0.161\n0.145\n0.192\n\n\nOutpatient BUP + SMM\nModerate\nNon-Hispanic Black\nNo Pain\n0.170\n0.136\n0.200\n\n\nOutpatient BUP + SMM\nModerate\nNon-Hispanic Black\nVery mild to Moderate Pain\n0.667\n0.653\n0.681\n\n\nOutpatient BUP + SMM\nModerate\nNon-Hispanic Black\nSevere Pain\n0.163\n0.147\n0.183\n\n\nOutpatient BUP + SMM\nModerate\nHispanic\nNo Pain\n0.206\n0.200\n0.214\n\n\nOutpatient BUP + SMM\nModerate\nHispanic\nVery mild to Moderate Pain\n0.607\n0.604\n0.610\n\n\nOutpatient BUP + SMM\nModerate\nHispanic\nSevere Pain\n0.187\n0.182\n0.190\n\n\nOutpatient BUP + SMM\nModerate\nOther\nNo Pain\n0.107\n0.088\n0.127\n\n\nOutpatient BUP + SMM\nModerate\nOther\nVery mild to Moderate Pain\n0.662\n0.660\n0.663\n\n\nOutpatient BUP + SMM\nModerate\nOther\nSevere Pain\n0.231\n0.213\n0.250\n\n\nOutpatient BUP + SMM\nSevere\nNon-Hispanic White\nNo Pain\n0.051\n0.049\n0.053\n\n\nOutpatient BUP + SMM\nSevere\nNon-Hispanic White\nVery mild to Moderate Pain\n0.610\n0.607\n0.612\n\n\nOutpatient BUP + SMM\nSevere\nNon-Hispanic White\nSevere Pain\n0.339\n0.335\n0.344\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nImportant\n\n\n\nExtended-release (injected) naltrexone and buprenorphine administered in institutionalized settings were associated to higher probabilities of pain relief. Lower probabilities of pain relief, and smaller differences between treatments were detected in patients with more severe withdrawal symptoms.\n\n\n\n\n\n\nWhen a patient with an addiction tries to stop taking the opioid, he or she may feel the symptoms of withdrawal, which include anxiety, wanting to take the drug again, hyperactivity, being easily agitated, increase in the blood pressure and heart rate, or rapid breathing. Though temporary, opioid withdrawal can be incredibly debilitating.\nIn this section, we performed a predictive model using a multinomial log-linear model to predict the responses on withdrawal symptoms of patients after being treated adjusting by the symptomatology before receiving the treatment and other demographics characteristics such as gender and race. In addition, we compared several models’ fit to ensure we predict the responses using the most exact model.\n\n\n\n# ensuring replicability\nset.seed(19042023)\n\n# Fitting the model with treatment and pre-score predictors\nmod &lt;- multinom(factor(withdrawal_post) ~ treatment + withdrawal_pre, \n                data = data,\n                trace = FALSE)\n\n# Fitting the model with treatment, pre-score, and gender predictors\nmod.1 &lt;- multinom(factor(withdrawal_post) ~ treatment + withdrawal_pre + is_male, data = data,\n                trace = FALSE)\n\n# Fitting the model with treatment, pre-score, gender, and race predictors\nmod.2 &lt;- multinom(factor(withdrawal_post) ~ treatment + withdrawal_pre + is_male + race, \n                  data = data,\n                trace = FALSE)\n\n\n\n\nNext, we are going to compare the fit of the performed models. We used two model fit parameters: the Akaike Information Criterion (AIC) and the deviance. Lower values in both parameters mean a better model fit. Differences in more than 5 points in the AIC is sufficient to rule out the model with the higher AIC value.\n\n## Model fit comparison\ndata.frame(Model = c(\"Model (treat + pre)\",\n                     \"Model (treat + pre + is_male\",\n                     \"Model (treat + pre + is_male + race)\"),\n           AIC = c(mod$AIC, mod.1$AIC, mod.2$AIC),\n           Deviance = c(mod$deviance, mod.1$deviance, mod.2$deviance)) %&gt;%\n  kbl()\n\n\n\n\nModel\nAIC\nDeviance\n\n\n\n\nModel (treat + pre)\n3529.243\n3475.243\n\n\nModel (treat + pre + is_male\n3519.824\n3459.824\n\n\nModel (treat + pre + is_male + race)\n3513.820\n3435.820\n\n\n\n\n\n\n\nThe model with all predictors (i.e., the assigned treatment, the severity of withdrawal symptoms before the treatment, the gender, and the race) outperformed the rest of models. Therefore, we will use it to predict the probability of withdrawal symptoms considering the treatment received and the severity of withdrawal symptoms before treatment adjusted by gender and race.\n\n\n\n\n\nplot_predictions(mod.2, condition = c(\"withdrawal_pre\", \"treatment\"), type = \"probs\") +\n  facet_wrap(~ group,\n             labeller = as_labeller(c(\"0\" = \"Final status: No symptoms\",\n                                      \"1\" = \"Final status: Mild symptoms\",\n                                      \"2\" = \"Final status: Moderate symptoms\",\n                                      \"3\" = \"Final status: Severe symptoms\"))) +\n  labs(x = \"Withdrawal symptoms before the treatment\",\n       y = \"Probability of achieving the final status after treatment\",\n       col = \"Treatment\") +\n  theme_dark() +\n  scale_color_viridis_d(option = \"H\") +\n  scale_x_discrete(labels = c(\"None\",\n                              \"Mild\",\n                              \"Moderate\",\n                              \"Severe\")) +\n  theme(legend.position = \"bottom\",\n        legend.box = \"vertical\")\n\n\n\n\n(a) Notes. BUP: Buprenorphine; NR-NTX: Extended-release Naltrexone; SMM: Standard Medical Management; EMM: Enhanced Medical Management (SMM + Indivdual Drug Counselling).\n\n\n\nFigure 2: Predictions for withdrawal symptoms severity adjusted by gender, self-reported race, and withdrawal symptoms before treatment.\n\n\nIn Figure 2 we can observe the treatment predicted responses to withdrawal symptoms. The treatments showing the highest probability of no withdrawal symptoms after treatment regardless the associated symptoms before treatment involvement were those based on Outpatient Buprenorphine + Enhanced Medical Management (defined as Standard Medical Management plus Individual Drug Counselling) and Outpatient Buprenorphine + Standard Medical Management. For example, a person who suffered severe opiod withdrawal symptoms before treatment and received Outpatient Buprenorphine + EMM had a probability of 0.693 (95% CI 0.658 to 0.716) of total withdrawal symptoms recovery. Comparably, if the same person would receive Methadone or isolated Outpatient Buprenorphine (i.e., no EMM or SMM), he/she would have probabilities of no withdrawal symptoms of 0.279 (95% CI 0.218 to 0.412), and 0.231 (95% CI 0.171 to 0.329), respectively. Evidence showing different characteristics associated to outpatient and inpatient settings suggests that outpatients can be favored for controlling withdrawal symptoms (Varney et al. 2021). In addition, inpatient treatments resulted in less effective interventions, achieving a potential reduction of severe symptoms, but with a very low probability of total withdrawal symptoms recovery. Naltrexone presented more benefits than buprenorphine in inpatients for withdrawal symptoms. Evidence supports this finding showing that naltrexone is an opioid antagonist, meaning that it works differently than methadone and buprenorphine to treat OUD by blocking opioid receptor activity (Varney et al. 2021). Numerical values are presented in Table 2.\n\npredictions(mod.2) %&gt;%\n  group_by(treatment, withdrawal_pre, group) %&gt;%\n  mean_qi(estimate) %&gt;% \n  as.data.frame() %&gt;% \n  mutate(withdrawal_pre = case_when(\n    withdrawal_pre == \"0\" ~ \"No symptoms\",\n    withdrawal_pre == \"1\" ~ \"Mild symptoms\",\n    withdrawal_pre == \"2\" ~ \"Moderate symptoms\",\n    withdrawal_pre == \"3\" ~ \"Severe symptoms\"\n  ),\n  group = case_when(\n    group == \"0\" ~ \"No symptoms\",\n    group == \"1\" ~ \"Mild symptoms\",\n    group == \"2\" ~ \"Moderate symptoms\",\n    group == \"3\" ~ \"Severe symptoms\"\n  )) %&gt;%\n  rename(Treatment = treatment,\n         `Symptoms before\\ntreatment` = withdrawal_pre,\n         `Symptoms after\\ntreatment` = group,\n         Probability = estimate,\n         `95% lower bound` = .lower,\n         `95% upper bound` = .upper) %&gt;%\n  select(Treatment, `Symptoms before\\ntreatment`,\n         `Symptoms after\\ntreatment`, Probability, \n         `95% lower bound`, `95% upper bound`) %&gt;%\n  mutate_if(is.numeric, round, 3) %&gt;%\n  kbl()\n\n\nTable 2: Table 2. Predicted probabilities of withdrawal symptoms after treatment.\n\n\n\n\n(a) Notes. 95% CI corresponds to the 95% confidence interval of the predicted probability.\n\n\nTreatment\nSymptoms before treatment\nSymptoms after treatment\nProbability\n95% lower bound\n95% upper bound\n\n\n\n\nInpatient BUP\nNo symptoms\nNo symptoms\n0.343\n0.334\n0.352\n\n\nInpatient BUP\nNo symptoms\nMild symptoms\n0.584\n0.565\n0.602\n\n\nInpatient BUP\nNo symptoms\nModerate symptoms\n0.074\n0.064\n0.084\n\n\nInpatient BUP\nNo symptoms\nSevere symptoms\n0.000\n0.000\n0.000\n\n\nInpatient BUP\nMild symptoms\nNo symptoms\n0.144\n0.101\n0.225\n\n\nInpatient BUP\nMild symptoms\nMild symptoms\n0.737\n0.661\n0.784\n\n\nInpatient BUP\nMild symptoms\nModerate symptoms\n0.094\n0.063\n0.146\n\n\nInpatient BUP\nMild symptoms\nSevere symptoms\n0.026\n0.020\n0.036\n\n\nInpatient BUP\nModerate symptoms\nNo symptoms\n0.057\n0.040\n0.095\n\n\nInpatient BUP\nModerate symptoms\nMild symptoms\n0.646\n0.571\n0.716\n\n\nInpatient BUP\nModerate symptoms\nModerate symptoms\n0.187\n0.120\n0.251\n\n\nInpatient BUP\nModerate symptoms\nSevere symptoms\n0.110\n0.091\n0.166\n\n\nInpatient BUP\nSevere symptoms\nNo symptoms\n0.028\n0.018\n0.046\n\n\nInpatient BUP\nSevere symptoms\nMild symptoms\n0.429\n0.365\n0.482\n\n\nInpatient BUP\nSevere symptoms\nModerate symptoms\n0.240\n0.173\n0.329\n\n\nInpatient BUP\nSevere symptoms\nSevere symptoms\n0.303\n0.264\n0.394\n\n\nInpatient NR-NTX\nNo symptoms\nNo symptoms\n0.539\n0.479\n0.657\n\n\nInpatient NR-NTX\nNo symptoms\nMild symptoms\n0.438\n0.326\n0.481\n\n\nInpatient NR-NTX\nNo symptoms\nModerate symptoms\n0.023\n0.016\n0.041\n\n\nInpatient NR-NTX\nNo symptoms\nSevere symptoms\n0.000\n0.000\n0.000\n\n\nInpatient NR-NTX\nMild symptoms\nNo symptoms\n0.268\n0.197\n0.389\n\n\nInpatient NR-NTX\nMild symptoms\nMild symptoms\n0.693\n0.581\n0.755\n\n\nInpatient NR-NTX\nMild symptoms\nModerate symptoms\n0.032\n0.021\n0.051\n\n\nInpatient NR-NTX\nMild symptoms\nSevere symptoms\n0.007\n0.006\n0.013\n\n\nInpatient NR-NTX\nModerate symptoms\nNo symptoms\n0.125\n0.099\n0.210\n\n\nInpatient NR-NTX\nModerate symptoms\nMild symptoms\n0.758\n0.667\n0.802\n\n\nInpatient NR-NTX\nModerate symptoms\nModerate symptoms\n0.077\n0.046\n0.109\n\n\nInpatient NR-NTX\nModerate symptoms\nSevere symptoms\n0.040\n0.031\n0.070\n\n\nInpatient NR-NTX\nSevere symptoms\nNo symptoms\n0.080\n0.057\n0.136\n\n\nInpatient NR-NTX\nSevere symptoms\nMild symptoms\n0.645\n0.542\n0.698\n\n\nInpatient NR-NTX\nSevere symptoms\nModerate symptoms\n0.137\n0.086\n0.189\n\n\nInpatient NR-NTX\nSevere symptoms\nSevere symptoms\n0.137\n0.115\n0.211\n\n\nMethadone\nNo symptoms\nNo symptoms\n0.826\n0.778\n0.889\n\n\nMethadone\nNo symptoms\nMild symptoms\n0.166\n0.107\n0.209\n\n\nMethadone\nNo symptoms\nModerate symptoms\n0.008\n0.004\n0.014\n\n\nMethadone\nNo symptoms\nSevere symptoms\n0.000\n0.000\n0.000\n\n\nMethadone\nMild symptoms\nNo symptoms\n0.563\n0.477\n0.706\n\n\nMethadone\nMild symptoms\nMild symptoms\n0.421\n0.285\n0.502\n\n\nMethadone\nMild symptoms\nModerate symptoms\n0.016\n0.008\n0.026\n\n\nMethadone\nMild symptoms\nSevere symptoms\n0.001\n0.000\n0.001\n\n\nMethadone\nModerate symptoms\nNo symptoms\n0.354\n0.284\n0.513\n\n\nMethadone\nModerate symptoms\nMild symptoms\n0.595\n0.456\n0.657\n\n\nMethadone\nModerate symptoms\nModerate symptoms\n0.047\n0.027\n0.072\n\n\nMethadone\nModerate symptoms\nSevere symptoms\n0.004\n0.003\n0.006\n\n\nMethadone\nSevere symptoms\nNo symptoms\n0.279\n0.218\n0.412\n\n\nMethadone\nSevere symptoms\nMild symptoms\n0.595\n0.494\n0.652\n\n\nMethadone\nSevere symptoms\nModerate symptoms\n0.109\n0.063\n0.151\n\n\nMethadone\nSevere symptoms\nSevere symptoms\n0.018\n0.013\n0.025\n\n\nOutpatient BUP\nNo symptoms\nNo symptoms\n0.770\n0.730\n0.788\n\n\nOutpatient BUP\nNo symptoms\nMild symptoms\n0.204\n0.186\n0.231\n\n\nOutpatient BUP\nNo symptoms\nModerate symptoms\n0.026\n0.020\n0.040\n\n\nOutpatient BUP\nNo symptoms\nSevere symptoms\n0.000\n0.000\n0.000\n\n\nOutpatient BUP\nMild symptoms\nNo symptoms\n0.539\n0.444\n0.682\n\n\nOutpatient BUP\nMild symptoms\nMild symptoms\n0.409\n0.289\n0.488\n\n\nOutpatient BUP\nMild symptoms\nModerate symptoms\n0.051\n0.029\n0.087\n\n\nOutpatient BUP\nMild symptoms\nSevere symptoms\n0.001\n0.001\n0.001\n\n\nOutpatient BUP\nModerate symptoms\nNo symptoms\n0.305\n0.242\n0.468\n\n\nOutpatient BUP\nModerate symptoms\nMild symptoms\n0.543\n0.436\n0.598\n\n\nOutpatient BUP\nModerate symptoms\nModerate symptoms\n0.146\n0.089\n0.213\n\n\nOutpatient BUP\nModerate symptoms\nSevere symptoms\n0.005\n0.004\n0.008\n\n\nOutpatient BUP\nSevere symptoms\nNo symptoms\n0.231\n0.171\n0.329\n\n\nOutpatient BUP\nSevere symptoms\nMild symptoms\n0.503\n0.433\n0.556\n\n\nOutpatient BUP\nSevere symptoms\nModerate symptoms\n0.247\n0.190\n0.352\n\n\nOutpatient BUP\nSevere symptoms\nSevere symptoms\n0.018\n0.016\n0.024\n\n\nOutpatient BUP + EMM\nMild symptoms\nNo symptoms\n0.883\n0.862\n0.935\n\n\nOutpatient BUP + EMM\nMild symptoms\nMild symptoms\n0.114\n0.063\n0.133\n\n\nOutpatient BUP + EMM\nMild symptoms\nModerate symptoms\n0.003\n0.001\n0.005\n\n\nOutpatient BUP + EMM\nMild symptoms\nSevere symptoms\n0.000\n0.000\n0.000\n\n\nOutpatient BUP + EMM\nModerate symptoms\nNo symptoms\n0.757\n0.731\n0.834\n\n\nOutpatient BUP + EMM\nModerate symptoms\nMild symptoms\n0.228\n0.153\n0.248\n\n\nOutpatient BUP + EMM\nModerate symptoms\nModerate symptoms\n0.015\n0.008\n0.021\n\n\nOutpatient BUP + EMM\nModerate symptoms\nSevere symptoms\n0.000\n0.000\n0.000\n\n\nOutpatient BUP + EMM\nSevere symptoms\nNo symptoms\n0.693\n0.658\n0.716\n\n\nOutpatient BUP + EMM\nSevere symptoms\nMild symptoms\n0.270\n0.257\n0.289\n\n\nOutpatient BUP + EMM\nSevere symptoms\nModerate symptoms\n0.037\n0.026\n0.053\n\n\nOutpatient BUP + EMM\nSevere symptoms\nSevere symptoms\n0.000\n0.000\n0.000\n\n\nOutpatient BUP + SMM\nNo symptoms\nNo symptoms\n0.952\n0.952\n0.952\n\n\nOutpatient BUP + SMM\nNo symptoms\nMild symptoms\n0.047\n0.047\n0.047\n\n\nOutpatient BUP + SMM\nNo symptoms\nModerate symptoms\n0.001\n0.001\n0.001\n\n\nOutpatient BUP + SMM\nNo symptoms\nSevere symptoms\n0.000\n0.000\n0.000\n\n\nOutpatient BUP + SMM\nMild symptoms\nNo symptoms\n0.858\n0.838\n0.923\n\n\nOutpatient BUP + SMM\nMild symptoms\nMild symptoms\n0.136\n0.075\n0.153\n\n\nOutpatient BUP + SMM\nMild symptoms\nModerate symptoms\n0.006\n0.002\n0.009\n\n\nOutpatient BUP + SMM\nMild symptoms\nSevere symptoms\n0.000\n0.000\n0.000\n\n\nOutpatient BUP + SMM\nModerate symptoms\nNo symptoms\n0.725\n0.690\n0.844\n\n\nOutpatient BUP + SMM\nModerate symptoms\nMild symptoms\n0.253\n0.147\n0.278\n\n\nOutpatient BUP + SMM\nModerate symptoms\nModerate symptoms\n0.023\n0.009\n0.032\n\n\nOutpatient BUP + SMM\nModerate symptoms\nSevere symptoms\n0.000\n0.000\n0.000\n\n\nOutpatient BUP + SMM\nSevere symptoms\nNo symptoms\n0.606\n0.606\n0.606\n\n\nOutpatient BUP + SMM\nSevere symptoms\nMild symptoms\n0.316\n0.316\n0.316\n\n\nOutpatient BUP + SMM\nSevere symptoms\nModerate symptoms\n0.079\n0.079\n0.079\n\n\nOutpatient BUP + SMM\nSevere symptoms\nSevere symptoms\n0.000\n0.000\n0.000\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFortunately, longitudinal registers of withdrawal symptoms are also collected. These data can help us to understand how opioid withdrawal symptoms fluctuate across time depending on the treatment and dose administered.\n\n\nTo model these data, we used a generalized additive model (GAM), which can capture non-linear patterns, and are particularly valuable when investigating intricate dependencies (e.g., across time). First and foremost, we generated the dataset.\n\n# Generating the dataset containing longitudinal registers for withdrawal symptoms\ngam_data &lt;- treatment %&gt;%\n  left_join(withdrawal, by = c(\"who\", \"when\")) %&gt;%\n  left_join(data %&gt;%\n              select(who, treatment, is_male, race))\n\n# Setting a seed for replicability\nset.seed(123)\n\n# fitting a generalized additive model (GAM) adjusting by treatment-dose interaction\nmodel &lt;- bam(withdrawal ~ treatment:amount + s(when, by = treatment) + s(who, bs = \"re\"),\n             data = gam_data %&gt;% mutate(withdrawal = as.numeric(withdrawal)),\n             family = gaussian())\n\n# computing predictions\npred_gam &lt;- predictions(model)\n\nClinicians can gain advantage of these results optimizing the dose needed to alleviate those symptoms, pruning the probability of potential overdose cases. In Figure 3, it can be observed that methadone administered in higher doses (e.g., 50 mg/day) did not show improvements in the first 10 days. Comparably, higher doses of buprenorphine in inpatients did not show benefits on withdrawal symptoms compared to lower doses, which reduced the severity of these symptoms. Injected naltrexone on inpatients presented a reduction in withdrawal symptoms up to three months after treatment beginning. Higher doses of buprenorphine in outpatients can be related to patients with more severe additions, and thus, more severe withdrawal symptoms; so, it can be beneficial for those patients to receive medically-controlled prescribed higher doses. Conversely, when buprenorphine is administered to outpatients combined with EMM or SMM, higher doses were associated with benefits on those symptoms.\n\n\n# plot\npred_gam %&gt;%\n  group_by(treatment, amount, when) %&gt;%\n  mean_qi(estimate) %&gt;% \n  mutate(estimate_class = case_when(\n    estimate &lt; 0.5 ~ \"None\",\n    estimate &gt;= 0.5 & estimate &lt; 1.5 ~ \"Mild\",\n    estimate &gt;= 1.5 & estimate &lt; 2.5 ~ \"Moderate\",\n    estimate &gt;= 2.5 ~ \"Severe\"\n  )) %&gt;%\n  ggplot(aes(x = when, y = amount, z = estimate)) +\n  geom_tile(aes(fill = estimate_class)) +\n  facet_wrap(~ treatment, scales = \"free_x\") +\n  labs(x = \"Time (days)\",\n       y = \"Doses (mg of administered drug)\",\n       fill = \"Withdrawal symptoms\") +\n  theme_dark() +\n  scale_fill_manual(values = c(\"Mild\" = \"yellow\",\n                               \"Moderate\" = \"orange\",\n                               \"Severe\" = \"red\")) +\n  theme(legend.position = \"bottom\",\n        legend.box = \"vertical\") +\n  scale_y_continuous(breaks = c(1, seq(10, 60, 10)),\n                     labels = c(\"Injected\", seq(10, 60, 10)))\n\n\n\n\n(a) Notes. BUP: Buprenorphine; NR-NTX: Extended-release Naltrexone; SMM: Standard Medical Management; EMM: Enhanced Medical Management (SMM + Indivdual Drug Counselling).\n\n\n\nFigure 3: Withdrawal symptoms across time for different doses of the analyzed treatments.\n\n\n\n\n\n\n\n\nImportant\n\n\n\nBuprenorphine + EMM or SMM was the most beneficial for alleviating withdrawal symptoms in outpatients. For inpatients, injectable naltrexone seems to be a better option to face withdrawal symptoms than methadone. More doses have not to be necessarily associated with better outcomes, which should be carefully prescribed.\n\n\n\n\n\n\n\nAfter predicting the most beneficial treatments for alleviating withdrawal symptoms, it is needed to analyze which of them have associated the lowest attrition rate (i.e., the highest adherence to the treatment), since it is a key factor to achieve the predicted effectiveness. Currently, adherence to and retention in medications for OUD (i.e., the continuous engagement in treatment) is incompletely understood by healthcare professionals (Viera et al. 2020). Several factors at the individual, interpersonal, and institutional levels have been associated to OUD treatments; among them, OUD treatment dosage, which will be analyzed in the next section.\n\n\nBased on previous exploratory data analyses, we conducted a linear model to predict adherence rates using the assigned treatment, the race of the participant, and the withdrawal symptoms before receiving the assigned treatment.\n\n# Setting a seed for replicability\nset.seed(123)\n\n# Fitting the model\nmodel_ad &lt;- lm(perc ~ treatment + race + withdrawal_pre, data = data %&gt;% filter(!is.na(withdrawal_pre)))\n\n# Summary of the model\nsummary(model_ad)\n\n\nCall:\nlm(formula = perc ~ treatment + race + withdrawal_pre, data = data %&gt;% \n    filter(!is.na(withdrawal_pre)))\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.63716 -0.26443  0.06062  0.24340  0.51987 \n\nCoefficients:\n                              Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)                    0.48978    0.04708  10.404  &lt; 2e-16 ***\ntreatmentInpatient NR-NTX     -0.13187    0.02540  -5.192 2.26e-07 ***\ntreatmentMethadone             0.12200    0.02297   5.312 1.19e-07 ***\ntreatmentOutpatient BUP       -0.05674    0.02178  -2.604  0.00926 ** \ntreatmentOutpatient BUP + EMM -0.07874    0.02490  -3.163  0.00158 ** \ntreatmentOutpatient BUP + SMM -0.04556    0.02499  -1.823  0.06838 .  \nraceNon-Hispanic Black        -0.01743    0.02207  -0.790  0.42966    \nraceHispanic                  -0.03737    0.01816  -2.058  0.03970 *  \nraceOther                     -0.03985    0.02674  -1.490  0.13632    \nwithdrawal_pre1                0.10538    0.04485   2.349  0.01889 *  \nwithdrawal_pre2                0.08688    0.04523   1.921  0.05486 .  \nwithdrawal_pre3                0.08376    0.04916   1.704  0.08854 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.286 on 2330 degrees of freedom\n  (238 observations deleted due to missingness)\nMultiple R-squared:  0.07712,   Adjusted R-squared:  0.07277 \nF-statistic:  17.7 on 11 and 2330 DF,  p-value: &lt; 2.2e-16\n\n\n\n\n\nTo ease the interpretation of the model, these numbers displayed help us to predict the adherence rate of a participant with specific characteristics. For example, we can predict the adherence rate of a non-hispanic black participant who were assigned to the “Inpatient BUP” treatment with severe withdrawal symptoms.\n\n# Prediction model\nprediction &lt;- predict(model_ad, newdata = tibble(race = \"Non-Hispanic Black\",\n                                       treatment = \"Inpatient BUP\",\n                                       withdrawal_pre = \"3\")) %&gt;% as.numeric()\n\n# Result\npaste(\"The predicted adherence rate for a non-Hispanic black participant with severe withdrawal symptoms assigned to the Inpatient BUP treatment is \", round(prediction, 2) * 100, \"%\", sep = \"\")\n## [1] \"The predicted adherence rate for a non-Hispanic black participant with severe withdrawal symptoms assigned to the Inpatient BUP treatment is 56%\"\n\nWe can see that if the same person would be assigned to another treatment (e.g., “Methadone”), the adherence rate would be different.\n\n# Prediction model\nprediction &lt;- predict(model_ad, newdata = tibble(race = \"Non-Hispanic Black\",\n                                       treatment = \"Methadone\",\n                                       withdrawal_pre = \"3\")) %&gt;% as.numeric()\n\n# Result\npaste(\"The predicted adherence rate for a non-Hispanic black participant with severe withdrawal symptoms assigned to the Inpatient BUP treatment is \", round(prediction, 2) * 100, \"%\", sep = \"\")\n## [1] \"The predicted adherence rate for a non-Hispanic black participant with severe withdrawal symptoms assigned to the Inpatient BUP treatment is 68%\"\n\nIn Figure 4, we can observe the variability in the adherence rate considering which treatment they received, and the withdrawal symptoms they experienced before treatment. Methadone showed really good adherence rates followed by the buprenorphine administered in participants who were institutionalized. It is an interesting finding, since we previously found that buprenorphine + EMM or SMM were the most effective interventions to reduce withdrawal symptoms; however, the adherence to the treatment is one of the most important factors to consider when a clinician prescribes a specific treatment in OUD patients. Therefore, it seems that methadone is one of the best treatments that showed a valuable trade-off between effectiveness and patient adherence. Additionally, patients that suffered from withdrawal symptoms regardless the severity of them had associated more adherence rates than patients with no symptoms. That could be explained by the need of people suffering withdrawal symptoms to alleviate these symptoms with treatment drugs.\n\n# data frame for prediction\nnewdata &lt;- expand.grid(race = unique(data$race),\n                       treatment = unique(data$treatment),\n                       withdrawal_pre = unique(data$withdrawal_pre)) %&gt;% \n  drop_na()\n\n# predictions \npred &lt;- predict(model_ad, newdata)\n\n\n\n# plotting predictions\nnewdata %&gt;% cbind(pred) %&gt;%\n  mutate(treatment = reorder(treatment, pred)) %&gt;%\n  ggplot(aes(y = pred, x = withdrawal_pre)) +\n  stat_pointinterval(aes(col = treatment),\n                     position = position_dodge(width = 0.3)) +\n  theme_dark() +\n  scale_color_viridis_d(option = \"H\") +\n  scale_x_discrete(labels = c(\"None\",\n                              \"Mild\",\n                              \"Moderate\",\n                              \"Severe\")) +\n  theme(legend.position = \"bottom\",\n        legend.box = \"vertical\") +\n  labs(x = \"Withdrawal symptoms before treatment\",\n       y = \"Probability of predicted adherence rate (attended sessions)\",\n       col = \"Treatment\") +\n  scale_y_continuous(breaks = seq(0.2, 1, 0.05))\n\n\n\n\n(a) Notes. BUP: Buprenorphine; NR-NTX: Extended-release Naltrexone; SMM: Standard Medical Management; EMM: Enhanced Medical Management (SMM + Indivdual Drug Counselling).\n\n\n\nFigure 4: Predictions for adherence rates in the analyzed treatments adjusting by different severity degress of withdrawal symptoms before treatment.\n\n\n\n\n\nAs we stated in the previous section, medication dosage can play a role in the treatment adherence. Therefore, we used the longitudinal dataset previously created to predict the adherence to the assigned treatment depending on the median dose that patients received.\n\n\n\n# linear model\nad.model.gam &lt;- gam_data %&gt;% group_by(who) %&gt;% median_qi(amount) %&gt;%\n  select(who, amount) %&gt;%\n  full_join(data, by = \"who\") %&gt;%\n  lm(perc ~ treatment:amount + withdrawal_pre + per_day, data = .) # model with best fit\n\n\n\n\nPercentage of adherence to the assigned treatment is shown in Figure 5. Medication dosage has a great influence on the treatment adherence regardless withdrawal symptoms before treatment, with higher doses associated with higher adherence. Administering the same dose in oral-consumed treatments, buprenorphine showed more adherence rates compared to methadone in outpatients. However, 60 mg/day of methadone was associated with the greatest treatment adherence rate. Injectable nalextrone achieved a considerable adherence rate in inpatients. As we have already detected, patients with no withdrawal symptoms had associated lower treatment adherence rates.\n\n\n# plotting the predictions\nmarginaleffects::predictions(ad.model.gam, \n                             newdata = datagrid(treatment = unique(data$treatment),\n                                                              amount = c(1, 10, 20, 30, 40, 50, 60),\n                                                              withdrawal_pre = unique(data$withdrawal_pre),\n                                                              per_day = unique(data$per_day)[c(1, 2, 4)])) %&gt;% \n  as.data.frame() %&gt;% \n  drop_na() %&gt;% \n  \n  # validating only approved doses of medications\n  mutate(check = case_when(\n    treatment == \"Inpatient NR-NTX\" & amount &gt; 1 ~ 1,\n    treatment %in% c(\"Inpatient BUP\",\n                     \"Outpatient BUP\",\n                     \"Outpatient BUP + EMM\",\n                     \"Outpatient BUP + SMM\") & amount &gt; 30 ~ 1,\n    TRUE ~ 0)) %&gt;%\n  filter(check == 0) %&gt;%\n  group_by(treatment, amount, withdrawal_pre) %&gt;%\n  mean_qi(estimate) %&gt;%\n  arrange(estimate) %&gt;%\n  ggplot(aes(x = amount, y = estimate)) +\n  geom_pointinterval(aes(col = withdrawal_pre,\n                         ymin = .lower, ymax = .upper),\n                     position = position_dodge(width = 5.5)) +\n  facet_wrap(~ treatment) +\n  labs(x = \"Dose (mg of administered drug)\",\n       y = \"Percentage of adherence to the assigned treatment\",\n       col = \"Withdrawal symptoms\") +\n  theme_dark() +\n  scale_color_viridis_d(option = \"H\",\n                        labels = c(\"None\",\n                                   \"Mild\",\n                                   \"Moderate\",\n                                   \"Severe\")) +\n  scale_y_continuous(breaks = seq(0.1, 1, 0.1),\n                     labels = scales::label_percent(),\n                     limits = c(0.3, 0.95)) +\n  scale_x_continuous(breaks = c(1, 10, 20, 30, 40, 50, 60),\n                     labels = c(\"1 or\\nInjected\", 10, 20, 30, 40, 50, 60)) +\n  theme(legend.position = \"bottom\",\n        legend.box = \"vertical\")\n\n\n\n\n(a) Notes. BUP: Buprenorphine; NR-NTX: Extended-release Naltrexone; SMM: Standard Medical Management; EMM: Enhanced Medical Management (SMM + Indivdual Drug Counselling). Injected drugs were only used in inpatients (i.e., buprenorphine and naltrexone).\n\n\n\nFigure 5: Predictions for adherence rates adjusted by drug dosage and withdrawal symptoms before treatment for the analyzed treatments.\n\n\n\n\n\n\n\n\nImportant\n\n\n\nMethadone was associated with the highest treatment adherence rates. Higher doses were associated with higher rates of treatment adherence. Administering a similar dose, buprenorphine also showed good adherence rates for outpatients and inpatients.\n\n\n\n\n\n\n\nWhile a large proportion of people with OUD return to consume at some point in their lives, the risk of death is mitigated by remaining in treatment. Moreover, the predicted effectiveness of the different analyzed treatments can vary if patients would not attend approximately half of the programmed visits (predictions were computed averaging the percentage of adherence rates = 44.06%). Thus, healthcare professionals should consider the mean adherence rate of the treatment of interest and its effectiveness on withdrawal symptoms alleviation, and pain relief when prescribing specific treatments for OUD patients. Therefore, when two treatments achieve similar effectiveness on an outcome of interest (e.g., after the initial physical and historical patient examination, it is possible that the main outcome that should be treated would be opioid withdrawal symptoms), the treatment that has associated higher adherence rates should be selected, and vice versa (i.e., if two treatments achieve similar adherence, the treatment predicted as the most beneficial should be selected). For a global vision of the main concerns in OUD patients, we present the Figure 6.\n\n\nFor adherence rates, we have just predicted outcomes following our linear model. For pain levels, we predicted the probabilities for the analyzed treatments to achieve a total pain relief (i.e., outcome = No Pain). For opioid withdrawal symptoms, we predicted for each level of severity (i.e., 0 = None; 1 = Mild; 2 = Moderate; 3 = Severe) only the probabilities to alleviate the symptoms that existed before treatment (e.g., if a patient suffered moderate withdrawal symptoms, the probabilities of achieve mild or any symptoms).\n\n# adherence rate data\nadherence.data &lt;- newdata %&gt;% \n  cbind(pred) %&gt;%\n  group_by(treatment, withdrawal_pre) %&gt;%\n  mean_qi(pred) %&gt;%\n  select(treatment, withdrawal_pre, pred, .lower, .upper) %&gt;%\n  rename(adherence = pred,\n         ad.lower = .lower,\n         ad.upper = .upper)\n\n# pain data\npain.data &lt;- marginaleffects::predictions(model.1) %&gt;% \n  as.data.frame() %&gt;%\n  filter(group != \"Missing\") %&gt;%\n  mutate(group = factor(group, levels = c(\"No Pain\",\n                                          \"Very mild to Moderate Pain\",\n                                          \"Severe Pain\"))) %&gt;%\n  group_by(treatment, withdrawal_pre, group) %&gt;%\n  mean_qi(estimate) %&gt;%\n  as.data.frame() %&gt;%\n  mutate(treatment = reorder(treatment, estimate)) %&gt;%\n  \n  # only conserve data related to 'no pain' outcomes\n  filter(group == \"No Pain\") %&gt;%\n  select(treatment, withdrawal_pre, estimate, .lower, .upper)\n\n\n\n# withdrawal effectiveness data\nwithd.data &lt;- predictions(mod.2) %&gt;%\n  group_by(treatment, withdrawal_pre, group) %&gt;%\n  mean_qi(estimate) %&gt;%\n  as.data.frame() %&gt;%\n  \n  # only conserve data correspond to withdrawal symptoms improvement\n  mutate(valid = case_when(\n    withdrawal_pre == 0 & group == 0 ~ 1,\n    withdrawal_pre == 1 & group == 0 ~ 1,\n    withdrawal_pre == 2 & group %in% c(0, 1) ~ 1,\n    withdrawal_pre == 3 & group %in% c(0, 1, 2) ~ 1,\n    TRUE ~ 0\n  )) %&gt;%\n  filter(valid == 1) %&gt;%\n  group_by(treatment, withdrawal_pre) %&gt;%\n  mean_qi(estimate) %&gt;%\n  select(treatment, withdrawal_pre, estimate, .lower, .upper) %&gt;%\n  rename(effectiveness = estimate, \n         ef.lower = .lower,\n         ef.upper = .upper)\n\n\n# combining predictions of the outcomes of interest\nfinal.data &lt;- adherence.data %&gt;% \n  full_join(withd.data, by = c(\"treatment\", \"withdrawal_pre\")) %&gt;%\n  full_join(pain.data, by = c(\"treatment\", \"withdrawal_pre\")) %&gt;%\n  mutate(withdrawal_pre = factor(withdrawal_pre,\n                                 levels = c(\"0\", \"1\", \"2\", \"3\"),\n                                 labels = c(\"None\",\n                                            \"Mild\", \n                                            \"Moderate\",\n                                            \"Severe\"))) %&gt;%\n  rename(`Withdrawal symptoms before treatment` = withdrawal_pre)\n\n\n\n\nTo ease the understanding of the Figure 6, you have to take into account:\n\nYou can stop the animation to observe the results for the treatment of interest for patients with specific withdrawal symptoms severity.\nIf you are not able to observe an axis title, you can rotate the figure.\nEach treatment has associated a specific color.\nYou can freely move the slider to observe the results for a determined withdrawal symptoms’ severity.\nIf you put your mouse over a point, the results for this point are displayed considering that axis x corresponds to the adherence rate, y axis refers to withdrawal symptoms’ improvement, and z axis corresponds to pain relief outcomes.\n\n\n# plot\nplot_ly(final.data,\n        x = ~adherence, y = ~effectiveness, z = ~estimate,\n        color = ~treatment,\n        frame = ~`Withdrawal symptoms before treatment`,\n        mode = \"markers\",\n        type = \"scatter3d\") %&gt;%\n  layout(scene = list(xaxis = list(title = \"Adherence\"),\n                      yaxis = list(title = \"Withdrawal symptoms improvement\"),\n                      zaxis = list(title = \"Pain relief\"))) %&gt;%\n  animation_opts(frame = 3000, easing = \"elastic\", redraw = TRUE) %&gt;%\n  animation_slider(currentvalue = list(prefix = \"Withdrawal symptoms before treatment: \",\n                                       font = list(color = \"red\")))\n\n\n\n\nFigure 6: Evidence on adherence, withdrawal symptoms alleviation, and pain relief for the analyzed treatments adjusted by different degrees of withdrawal symptoms before treatment severity.\n\n\n\n\n\n\n\n\n\nTake-home messages\n\n\n\nBased on the evidence synthesized in these analyses, we can establish the following care paths after initial withdrawal symptom severity diagnosis through physical examination, and patient clinical history. Depending on the main outcome of interest to treat, we propose the three most beneficial treatments for each case. When two treatments’ effectiveness were similar, the one with greater adherence rate appears first.\n\nFor patients with no withdrawal symptoms before treatment:\n\nOutcome of interest:\n\nPain: Inpatient BUP, Inpatient NR-NTX, or Outpatient BUP + SMM.\nWithdrawal symptoms: Outpatient BUP + SMM, Methadone, or isolated Outpatient BUP.\n\n\nFor patients with mild withdrawal symptoms before treatment:\n\nOutcome of interest:\n\nPain: Inpatient BUP, Inpatient NR-NTX, or Outpatient BUP + EMM (low effectiveness).\nWithdrawal symptoms: Outpatient BUP + EMM, Outpatient + SMM, or Methadone.\n\n\nFor patients with moderate withdrawal symptoms before treatment:\n\nOutcome of interest:\n\nPain: Inpatient BUP, Inpatient NR-NTX, or Outpatient BUP + EMM (low effectiveness).\nWithdrawal symptoms: Methadone, Outpatient BUP + SMM, or Outpatient BUP + EMM.\n\n\nFor patients with severe withdrawal symptoms before treatment:\n\nOutcome of interest:\n\nPain: Inpatient BUP, Inpatient NR-NTX, or Outpatient BUP + EMM (very low effectiveness).\nWithdrawal symptoms: Methadone, Outpatient BUP + SMM, or Outpatient BUP + EMM.\n\n\n\n\n\n\nsessionInfo()\n\nR version 4.3.2 (2023-10-31)\nPlatform: x86_64-apple-darwin20 (64-bit)\nRunning under: macOS Sonoma 14.3.1\n\nMatrix products: default\nBLAS:   /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib/libRblas.0.dylib \nLAPACK: /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0\n\nlocale:\n[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8\n\ntime zone: Europe/Madrid\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] plotly_4.10.4             DT_0.30                  \n [3] kableExtra_1.3.4          marginaleffects_0.16.0   \n [5] tvthemes_1.3.3            ggsci_3.0.0              \n [7] tidybayes_3.0.6           nnet_7.3-19              \n [9] mgcv_1.9-0                nlme_3.1-163             \n[11] brms_2.20.4               Rcpp_1.0.11              \n[13] ggplot2_3.4.4             tidyr_1.3.0              \n[15] dplyr_1.1.4               public.ctn0094extra_1.0.4\n[17] public.ctn0094data_1.0.6 \n\nloaded via a namespace (and not attached):\n  [1] gridExtra_2.3        inline_0.3.19        rlang_1.1.2         \n  [4] magrittr_2.0.3       matrixStats_1.1.0    compiler_4.3.2      \n  [7] loo_2.6.0            systemfonts_1.0.5    callr_3.7.3         \n [10] vctrs_0.6.5          reshape2_1.4.4       rvest_1.0.3         \n [13] stringr_1.5.1        pkgconfig_2.0.3      arrayhelpers_1.1-0  \n [16] crayon_1.5.2         fastmap_1.1.1        magick_2.8.3        \n [19] backports_1.4.1      ellipsis_0.3.2       labeling_0.4.3      \n [22] utf8_1.2.4           threejs_0.3.3        promises_1.2.1      \n [25] rmarkdown_2.25       markdown_1.11        ps_1.7.5            \n [28] purrr_1.0.2          xfun_0.41            jsonlite_1.8.7      \n [31] highr_0.10           later_1.3.1          parallel_4.3.2      \n [34] prettyunits_1.2.0    R6_2.5.1             dygraphs_1.1.1.6    \n [37] RColorBrewer_1.1-3   stringi_1.8.2        StanHeaders_2.26.28 \n [40] extrafontdb_1.0      rstan_2.32.3         knitr_1.45          \n [43] zoo_1.8-12           base64enc_0.1-3      extrafont_0.19      \n [46] bayesplot_1.10.0     httpuv_1.6.12        Matrix_1.6-1.1      \n [49] splines_4.3.2        igraph_2.0.2         tidyselect_1.2.0    \n [52] rstudioapi_0.15.0    abind_1.4-5          yaml_2.3.7          \n [55] codetools_0.2-19     miniUI_0.1.1.1       processx_3.8.2      \n [58] pkgbuild_1.4.2       lattice_0.21-9       tibble_3.2.1        \n [61] plyr_1.8.9           shiny_1.8.0          withr_2.5.2         \n [64] bridgesampling_1.1-2 posterior_1.5.0      coda_0.19-4         \n [67] evaluate_0.23        RcppParallel_5.1.7   xml2_1.3.5          \n [70] ggdist_3.3.1         xts_0.13.1           pillar_1.9.0        \n [73] tensorA_0.36.2       checkmate_2.3.0      stats4_4.3.2        \n [76] insight_0.19.7       shinyjs_2.1.0        distributional_0.3.2\n [79] generics_0.1.3       rstantools_2.3.1.1   munsell_0.5.0       \n [82] scales_1.3.0         gtools_3.9.5         xtable_1.8-4        \n [85] glue_1.6.2           lazyeval_0.2.2       tools_4.3.2         \n [88] shinystan_2.6.0      data.table_1.14.8    webshot_0.5.5       \n [91] colourpicker_1.3.0   mvtnorm_1.2-4        grid_4.3.2          \n [94] Rttf2pt1_1.3.12      QuickJSR_1.0.8       crosstalk_1.2.1     \n [97] colorspace_2.1-0     cli_3.6.1            fansi_1.0.5         \n[100] svUnit_1.0.6         viridisLite_0.4.2    svglite_2.1.2       \n[103] Brobdingnag_1.2-9    gtable_0.3.4         digest_0.6.33       \n[106] htmlwidgets_1.6.3    farver_2.1.1         htmltools_0.5.7     \n[109] lifecycle_1.0.4      httr_1.4.7           mime_0.12           \n[112] shinythemes_1.2.0"
  },
  {
    "objectID": "index.html#background",
    "href": "index.html#background",
    "title": "R/Medicine 2024 Data Challenge: Opioid Use Disorder",
    "section": "",
    "text": "Opioid use disorder (OUD) is defined as the chronic use of opioids that causes clinically significant distress or impairment. Symptoms of this disease include an overpowering desire to consume opioids, increased opioid tolerance, and withdrawal syndrome when opioids are discontinued (Leveille and Rambur 2024). OUD affects over 16 million people worldwide and over 2.1 million in the United States. While opioid painkillers prescriptions are becoming more closely regulated, cases of overdose and addiction are still increasing, especially among younger people. Thus, it is considered an important global health concern.\nIn this data analysis, we have tried to address how to optimize the treatments applied to alleviate OUD investigating their effectiveness against withdrawal symptoms, adherence, and pain."
  },
  {
    "objectID": "index.html#data-processing-and-management",
    "href": "index.html#data-processing-and-management",
    "title": "R/Medicine 2024 Data Challenge: Opioid Use Disorder",
    "section": "",
    "text": "First, we are going to load the required libraries to conduct the analyses.\n\nlibrary(public.ctn0094data)\nlibrary(public.ctn0094extra)\nlibrary(dplyr) # data wrangling\nlibrary(tidyr) # data wrangling too\nlibrary(ggplot2) # data visualization\nlibrary(brms) # generalized linear modelling\nlibrary(mgcv) # generalized additive models for very large datasets\nlibrary(nnet) # for multinomial neural network algorithm\nlibrary(tidybayes) # data analysis and plotting\nlibrary(ggsci) # extra plot themes\nlibrary(tvthemes) # additional themes\nlibrary(marginaleffects) # counterfactual predictions and treatment effects \nlibrary(kableExtra) # table display\nlibrary(DT) # table display\nlibrary(plotly) # data visualization\n\nSecond, we are going to set up a dataset that gathers all important information (i.e., variables of interest) which could help us to understand latent patterns for which some treatments can be potentially more beneficial (i.e., reducing withdrawal symptoms, or increasing treatment adherence) for a specific sub-population within OUD patients. Our start point will be the everybody dataset, which contains all the participants with their corresponding identifiers (who), and the project they belonged.\n\neverybody %&gt;% \n  head() %&gt;% \n  kbl() %&gt;% \n  kable_styling(full_width = FALSE, \n                position = \"left\")\n\n\n\n\nwho\nproject\n\n\n\n\n8\n27\n\n\n10\n27\n\n\n11\n27\n\n\n12\n27\n\n\n13\n27\n\n\n14\n27\n\n\n\n\n\n\n\nTo predict what type of patients could benefit more from OUD treatments, we add demographic information to our dataset.\n\n# selecting the variables of interest based on evidence that could potentially predict outcomes of interest\nnew.demo &lt;- demographics %&gt;%\n  select(who, age, education, marital, is_male) %&gt;%\n  cbind(derived_raceEthnicity$race_ethnicity) # adding the self-reported race and ethnicity from the extra data\n\n# dataset\ndata &lt;- everybody %&gt;%\n  full_join(new.demo, by = \"who\") %&gt;%\n  rename(race = `derived_raceEthnicity$race_ethnicity`)\n\nOpioid addiction is rarely a stand-alone illness; frequently, people with opioid dependence are also struggling with a mental health condition. Therefore, psychiatric information can be useful to identify conditions that can be associated with OUDs.\n\n# selectig variables related to the Addiction Severity Index-Lite Follow-up scale for depression, anxiety and schizophrenia\nnew.psycho &lt;- psychiatric %&gt;%\n  select(who, depression, anxiety, schizophrenia)\n\n# combining datasets\ndata &lt;- data %&gt;%\n  full_join(new.psycho, by = \"who\") %&gt;%\n  arrange(who)\n\nNext, the time span for detox is included in our data. We checked out whether any patient had just one data point.\n\n# Checking data points\ndetox %&gt;% \n  group_by(who) %&gt;% \n  summarise(n = n()) %&gt;% \n  ungroup() %&gt;% \n  filter(!n == 2)\n## # A tibble: 0 × 2\n## # ℹ 2 variables: who &lt;int&gt;, n &lt;int&gt;\n## all participants had admission and discharge data points\n\n# Creating the new variable with the detox time span for each patient\nnew.detox &lt;- detox %&gt;% \n  mutate(what = factor(what, levels = c(\"admission\", \n                                                \"discharge\"))) %&gt;% # ensuring levels' names\n  arrange(what) %&gt;% # ensuring discharge time point - admission time point\n  group_by(who) %&gt;% \n  summarise(when = last(when) - first(when))\n\n# combining datasets\ndata &lt;- data %&gt;%\n  full_join(new.detox, by = \"who\") %&gt;%\n  arrange(who)\n\nIt could be interesting exploring the relationship between nicotine and opioid use and abuse. There are several pathways by which unique nicotine-opioid interactions may confer greater risk for prescription opioid misuse. First, chronic nicotine exposure may result in dysregulation of the endogenous opioid system, leading to greater pain and cross-tolerance to prescription opioids. It can be a red flag: a person who is consuming a lot of cigarettes (i.e., nicotine), and put into practice programs to prevent opioid misuse.\n\n# combining datasets\ndata &lt;- data %&gt;% \n  left_join(fagerstrom, by = \"who\")\n\nAlso, an interesting factor that can be associated to OUD is the quality of life (i.e., whether people are homeless or living in a shelter). This data is provided by the PhenX Quality of Life Survey.\n\n# combining datasets\ndata &lt;- data %&gt;% \n  left_join(qol, by = \"who\")\n\nThe adherence to the programmed sessions could be a key predictor for health outcomes like withdrawal symptoms. We are going to extract the days that participants attended the programmed sessions, and calculate the percentage of satisfied sessions. These numbers have to be taken carefully because a session categorized as Missing could be a session where participant was late.\n\n# calculate the adherence of participants to programmed sessions as percentage dividing the attended visits by the total number of programmed visits\nnew.visit &lt;- derived_visitImputed %&gt;%\n  group_by(who, visitImputed) %&gt;%\n  summarise(n = n()) %&gt;%\n  pivot_wider(names_from = visitImputed, values_from = n) %&gt;%\n  ungroup() %&gt;%\n  mutate(total = Missing + Present,\n         perc = Present / total) %&gt;%\n  select(who, perc)\n\n# combining datasets\ndata &lt;- data %&gt;% \n  full_join(new.visit, by = \"who\")\n\nNext, we are going to add the treatment that each participant received, and the day they started the assigned treatment.\n\n# removing duplicated IDs (we ensured that duplicated participants received all the same treatement); assumption: if inductDelay is NA, then we used the randomization day as the day which treatments started\nnew.random &lt;- randomization %&gt;% \n  filter(!duplicated(who)) %&gt;%\n  mutate(inductDelay = derived_inductDelay$inductDelay,\n         final.when = ifelse(inductDelay %in% NA, when, when + inductDelay)) %&gt;%\n  select(who, treatment, final.when)\n\n# combining datasets\ndata &lt;- data %&gt;%\n  full_join(new.random, by = \"who\")\n\nAlso, it is important to see how treatments are effective against pain, which is the principal cause for which opioids are prescribed. Therefore, we select the pain scores that were registered after treatment engagement to identify, if possible, what treatment was associated to lower levels of pain.\n\n# combining datasets\ndata &lt;- data %&gt;% \n  full_join(pain, by = \"who\") %&gt;% \n  \n  # variable creation indicating whether the day registered in the pain dataset is higher than the day of treatment involvement (when.y is the day that pain was registered)\n  mutate(validation = ifelse(when.y &gt; final.when, 1, 0))\n\n# when we analyze pain, we should filter the dataset by only the values == 1\n\nFinally, we also add the withdrawal symptoms, which can be a condition in this population really debilitating. It would be really useful and informative to investigate which treatment caused the greatest withdrawal symptoms reduction and for which people.\n\n# creating the new withdrawal dataset\nnew_withdrawal &lt;- withdrawal_pre_post %&gt;% \n  \n  # transforming the dataset to wide format\n  pivot_wider(names_from = what, values_from = c(withdrawal, when)) %&gt;% \n  \n  # days between pain assessments\n  mutate(duration_pre_post = when_post - when_pre) %&gt;%\n\n# ordering columns\n  select(who, withdrawal_pre, withdrawal_post, when_pre, when_post, duration_pre_post)\n\n# It would be interesting to consider whether the symptoms were assessed before or after the patient started to received its assigned treatment\n\n\n# combining datasets\ndata &lt;- data %&gt;%\n  full_join(new_withdrawal, by = \"who\")\n\nOur final dataset looks like this:\n\ndata %&gt;%\n  mutate(perc = round(perc, 3)) %&gt;%\n  head() %&gt;%\n  kbl() %&gt;%\n  kable_styling(position = \"left\")\n\n\n\n\nwho\nproject\nage\neducation\nmarital\nis_male\nrace\ndepression\nanxiety\nschizophrenia\nwhen.x\nis_smoker\nftnd\nper_day\nis_homeless\nperc\ntreatment\nfinal.when\npain\nwhen.y\nvalidation\nwithdrawal_pre\nwithdrawal_post\nwhen_pre\nwhen_post\nduration_pre_post\n\n\n\n\n1\n30\n43\nMore than HS\nMarried or Partnered\nYes\nNon-Hispanic White\nNo\nNo\nNo\nNA\nYes\n6\n11-20\nNA\nNA\nNA\nNA\nNo Pain\n7\nNA\nNA\nNA\nNA\nNA\nNA\n\n\n2\n30\n30\nMore than HS\nNever married\nNo\nNon-Hispanic White\nYes\nYes\nNo\nNA\nYes\n1\n11-20\nNA\n0.600\nOutpatient BUP + EMM\n7\nSevere Pain\n0\n0\n1\n0\nNA\nNA\nNA\n\n\n3\n51\n23\nMore than HS\nNever married\nNo\nNon-Hispanic Black\nYes\nYes\nNo\n5\nYes\n3\n10 OR LESS\nYes\n0.091\nInpatient BUP\n13\nVery mild to Moderate Pain\n7\n0\n3\nNA\n5\nNA\nNA\n\n\n4\n51\n19\nMore than HS\nNever married\nYes\nNon-Hispanic White\nYes\nYes\nNo\n5\nYes\n2\n10 OR LESS\nNo\n0.917\nInpatient NR-NTX\n1\nVery mild to Moderate Pain\n0\n0\n1\n1\n0\n7\n7\n\n\n5\n30\n31\nNA\nNA\nNo\nNon-Hispanic White\nMissing\nMissing\nMissing\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\n\n\n6\n30\n43\nHS/GED\nMarried or Partnered\nYes\nNon-Hispanic White\nNo\nNo\nNo\nNA\nYes\n4\n31 OR MORE\nNA\n0.133\nOutpatient BUP + SMM\n16\nVery mild to Moderate Pain\n9\n0\n2\n0\nNA\nNA\nNA"
  },
  {
    "objectID": "index.html#pain",
    "href": "index.html#pain",
    "title": "R/Medicine 2024 Data Challenge: Opioid Use Disorder",
    "section": "",
    "text": "Opioids are often prescribed by doctors as painkillers, as they can relieve pain by blocking the pain signals between the body and the brain. The most effective treatment to relieve pain in these patients remain unknown due to the poor study methodology, and lack of evidence relating to possible harms (Avery et al. 2022). Thus, it would be useful for healthcare professionals evidence on which treatment is associated with lower pain levels, and in which specific subpopulations.\n\n\n\n\n\n\nNote\n\n\n\nTo conduct this analysis, we first filtered by pain registers collected after treatment involvement trying to establish an association between treatment, and post-treatment levels. It would be very helpful in future studies to collect pre-treatment data to analyze between and inter-personal variability on pain levels in this population.\n\n\n\n\nIn this section, we performed a predictive model using a multinomial log-linear model to predict the responses on pain levels of patients after being treated adjusting by the symptomatology before receiving the treatment and other demographics characteristics such as age and race. Then, we compared several models’ fit to ensure we predict the responses using the most exact model.\n\n# ensuring replicability\nset.seed(19042023)\n\n# fitting multinomial models\n## model adjusting by treatment \nmodel &lt;- multinom(pain ~ treatment, data = data, trace = FALSE)\n\n## model adjusting by treatment and other covariates\nmodel.1 &lt;- multinom(pain ~ treatment + race + age + withdrawal_pre, data = data, trace = FALSE)\n\n\n\n\nNext, we are going to compare the fit of the performed models. We used two model fit parameters: the Akaike Information Criterion (AIC) and the deviance. Lower values in both parameters mean a better model fit. Differences in more than 5 points in the AIC is sufficient to rule out the model with the higher AIC value.\n\n## model fit comparison\ndata.frame(Models = c(\"Model (treatment)\",\n                      \"Model (treatment + more predictors)\"),\n           AIC = c(model$AIC, model.1$AIC),\n           Deviance = c(model$deviance, model.1$deviance)) %&gt;%\n  kbl()\n\n\n\n\nModels\nAIC\nDeviance\n\n\n\n\nModel (treatment)\n4414.45\n4378.45\n\n\nModel (treatment + more predictors)\n4333.22\n4255.22\n\n\n\n\n\n\n\nThe model with all predictors (i.e., the assigned treatment, the severity of withdrawal symptoms before the treatment, age, and the race) outperformed the simplest model. Therefore, we will use it to predict the probability of pain relief considering the treatment received, the severity of withdrawal symptoms before treatment, and the self-reported race adjusted by age.\n\n\n\n\n\n# plot\nmarginaleffects::predictions(model.1) %&gt;% \n  as.data.frame() %&gt;%\n  filter(group != \"Missing\") %&gt;%\n  mutate(group = factor(group, levels = c(\"No Pain\",\n                                          \"Very mild to Moderate Pain\",\n                                          \"Severe Pain\"))) %&gt;%\n  group_by(treatment, withdrawal_pre, race, group) %&gt;%\n  mean_qi(estimate) %&gt;%\n  as.data.frame() %&gt;%\n  mutate(treatment = reorder(treatment, estimate)) %&gt;%\n  ggplot(aes(x = withdrawal_pre, y = .lower)) +\n  geom_pointinterval(aes(ymin = .lower, \n                         ymax = .upper, \n                         col = treatment),\n                     position = position_dodge(width = 0.5)) +\n  facet_grid(race ~ group, \n             scales = \"free\") +\n  labs(col = \"Treatment\",\n       x = \"Withdrawal symptoms before treatment\",\n       y = \"Probability of experimenting a specific pain level\") +\n  theme_dark() +\n  scale_color_viridis_d(option = \"H\") +\n  scale_y_continuous(limits = 0:1, \n                     breaks = seq(0, 1, 0.25)) +\n  scale_x_discrete(labels = c(\"None\",\n                              \"Mild \",\n                              \"Moderate\",\n                              \"Severe\")) +\n  theme(legend.position = \"bottom\",\n        legend.box = \"vertical\",\n        strip.text = element_text(size = 9))\n\n\n\n\n(a) Notes. BUP: Buprenorphine; NR-NTX: Extended-release Naltrexone; SMM: Standard Medical Management; EMM: Enhanced Medical Management (SMM + Indivdual Drug Counselling).\n\n\n\nFigure 1: Predictions for pain levels adjusted by race, age, and withdrawal symptoms before treatment involvement.\n\n\nWe can observe that naltrexone and buprenorphine administered to institutionalized patients showed the highest probability of total pain relief in all subpopulations regardless withdrawal symptoms before starting the treatment (Figure 1). Interestingly, more severe withdrawal symptoms before treatment involvement were associated with lower probabilities of pain relief; therefore, detox treatments for these patients are key for reducing opioid withdrawal symptoms, and potentially, achieve a complete pain relief. Although lack of rigorous evidence, a rapid review showed evidence supporting the practice of continuing methadone or buprenorphine for patients taking medication for OUD during acute pain episodes (Veazie et al. 2020). Furthermore, a clinical guideline for treating pain in patients with OUD by the Commonwealth of Pennsylvania also supports the use of buprenorphine for managing acute pain in OUD patients, indicating that there are data suggesting better performing of buprenorphine when compared to methadone, for example (Compton, Charuvastra, and Ling 2001). Evidence on naltrexone suggests that the extended-release (i.e., injectable) option is the preferred one for patients who would like to avoid taking any form of opioid or for whom buprenorphine or methadone are contraindicated (Connery 2015). Table 1 displays all numerical data.\n\n# table\nmarginaleffects::predictions(model.1) %&gt;% \n  as.data.frame() %&gt;%\n  filter(group != \"Missing\") %&gt;%\n  mutate(group = factor(group, levels = c(\"No Pain\",\n                                          \"Very mild to Moderate Pain\",\n                                          \"Severe Pain\"))) %&gt;%\n  mutate(withdrawal_pre = case_when(\n    withdrawal_pre == \"0\" ~ \"None\",\n    withdrawal_pre == \"1\" ~ \"Mild\",\n    withdrawal_pre == \"2\" ~ \"Moderate\",\n    withdrawal_pre == \"3\" ~ \"Severe\"\n  ),\n  withdrawal_pre = factor(withdrawal_pre, levels = c(\"None\",\n                                                     \"Mild\",\n                                                     \"Moderate\",\n                                                     \"Severe\"))) %&gt;%\n  group_by(treatment, withdrawal_pre, race, group) %&gt;%\n  mean_qi(estimate) %&gt;%\n  as.data.frame() %&gt;%\n  mutate(treatment = reorder(treatment, estimate)) %&gt;%\n  select(treatment, withdrawal_pre,\n         race, group, estimate,\n         .lower, .upper) %&gt;%\n  rename(Treatment = treatment,\n         `Symptoms before treatment` = withdrawal_pre,\n         Race = race,\n         `Pain level\\nafter treatment` = group,\n         Probability = estimate,\n         `95% lower bound` = .lower,\n         `95% upper bound` = .upper) %&gt;%\n  mutate_if(is.numeric, round, 3) %&gt;%\n  kbl()\n\n\nTable 1: Table 1. Predicted probabilities of pain level after treatment.\n\n\n\n\n(a) Notes. 95% CI corresponds to the 95% confidence interval of the predicted probability.\n\n\nTreatment\nSymptoms before treatment\nRace\nPain level after treatment\nProbability\n95% lower bound\n95% upper bound\n\n\n\n\nInpatient BUP\nNone\nNon-Hispanic White\nNo Pain\n0.759\n0.706\n0.791\n\n\nInpatient BUP\nNone\nNon-Hispanic White\nVery mild to Moderate Pain\n0.214\n0.187\n0.258\n\n\nInpatient BUP\nNone\nNon-Hispanic White\nSevere Pain\n0.027\n0.022\n0.036\n\n\nInpatient BUP\nNone\nNon-Hispanic Black\nNo Pain\n0.766\n0.766\n0.766\n\n\nInpatient BUP\nNone\nNon-Hispanic Black\nVery mild to Moderate Pain\n0.206\n0.206\n0.206\n\n\nInpatient BUP\nNone\nNon-Hispanic Black\nSevere Pain\n0.028\n0.028\n0.028\n\n\nInpatient BUP\nNone\nHispanic\nNo Pain\n0.806\n0.731\n0.846\n\n\nInpatient BUP\nNone\nHispanic\nVery mild to Moderate Pain\n0.165\n0.133\n0.223\n\n\nInpatient BUP\nNone\nHispanic\nSevere Pain\n0.029\n0.021\n0.046\n\n\nInpatient BUP\nMild\nNon-Hispanic White\nNo Pain\n0.481\n0.383\n0.536\n\n\nInpatient BUP\nMild\nNon-Hispanic White\nVery mild to Moderate Pain\n0.496\n0.445\n0.585\n\n\nInpatient BUP\nMild\nNon-Hispanic White\nSevere Pain\n0.023\n0.018\n0.031\n\n\nInpatient BUP\nMild\nNon-Hispanic Black\nNo Pain\n0.540\n0.467\n0.621\n\n\nInpatient BUP\nMild\nNon-Hispanic Black\nVery mild to Moderate Pain\n0.439\n0.365\n0.506\n\n\nInpatient BUP\nMild\nNon-Hispanic Black\nSevere Pain\n0.020\n0.015\n0.026\n\n\nInpatient BUP\nMild\nHispanic\nNo Pain\n0.579\n0.517\n0.627\n\n\nInpatient BUP\nMild\nHispanic\nVery mild to Moderate Pain\n0.396\n0.353\n0.452\n\n\nInpatient BUP\nMild\nHispanic\nSevere Pain\n0.024\n0.020\n0.031\n\n\nInpatient BUP\nMild\nOther\nNo Pain\n0.439\n0.380\n0.479\n\n\nInpatient BUP\nMild\nOther\nVery mild to Moderate Pain\n0.527\n0.491\n0.579\n\n\nInpatient BUP\nMild\nOther\nSevere Pain\n0.034\n0.029\n0.041\n\n\nInpatient BUP\nModerate\nNon-Hispanic White\nNo Pain\n0.392\n0.304\n0.437\n\n\nInpatient BUP\nModerate\nNon-Hispanic White\nVery mild to Moderate Pain\n0.580\n0.539\n0.658\n\n\nInpatient BUP\nModerate\nNon-Hispanic White\nSevere Pain\n0.029\n0.024\n0.038\n\n\nInpatient BUP\nModerate\nNon-Hispanic Black\nNo Pain\n0.433\n0.363\n0.499\n\n\nInpatient BUP\nModerate\nNon-Hispanic Black\nVery mild to Moderate Pain\n0.539\n0.479\n0.603\n\n\nInpatient BUP\nModerate\nNon-Hispanic Black\nSevere Pain\n0.028\n0.022\n0.035\n\n\nInpatient BUP\nModerate\nHispanic\nNo Pain\n0.500\n0.446\n0.525\n\n\nInpatient BUP\nModerate\nHispanic\nVery mild to Moderate Pain\n0.470\n0.448\n0.517\n\n\nInpatient BUP\nModerate\nHispanic\nSevere Pain\n0.031\n0.028\n0.037\n\n\nInpatient BUP\nModerate\nOther\nNo Pain\n0.322\n0.282\n0.363\n\n\nInpatient BUP\nModerate\nOther\nVery mild to Moderate Pain\n0.632\n0.597\n0.666\n\n\nInpatient BUP\nModerate\nOther\nSevere Pain\n0.046\n0.040\n0.053\n\n\nInpatient BUP\nSevere\nNon-Hispanic White\nNo Pain\n0.185\n0.143\n0.215\n\n\nInpatient BUP\nSevere\nNon-Hispanic White\nVery mild to Moderate Pain\n0.728\n0.707\n0.756\n\n\nInpatient BUP\nSevere\nNon-Hispanic White\nSevere Pain\n0.087\n0.078\n0.102\n\n\nInpatient BUP\nSevere\nNon-Hispanic Black\nNo Pain\n0.254\n0.211\n0.293\n\n\nInpatient BUP\nSevere\nNon-Hispanic Black\nVery mild to Moderate Pain\n0.670\n0.641\n0.702\n\n\nInpatient BUP\nSevere\nNon-Hispanic Black\nSevere Pain\n0.076\n0.067\n0.087\n\n\nInpatient BUP\nSevere\nHispanic\nNo Pain\n0.247\n0.176\n0.289\n\n\nInpatient BUP\nSevere\nHispanic\nVery mild to Moderate Pain\n0.648\n0.620\n0.693\n\n\nInpatient BUP\nSevere\nHispanic\nSevere Pain\n0.105\n0.091\n0.131\n\n\nInpatient BUP\nSevere\nOther\nNo Pain\n0.153\n0.144\n0.157\n\n\nInpatient BUP\nSevere\nOther\nVery mild to Moderate Pain\n0.724\n0.722\n0.729\n\n\nInpatient BUP\nSevere\nOther\nSevere Pain\n0.123\n0.121\n0.127\n\n\nInpatient NR-NTX\nNone\nNon-Hispanic White\nNo Pain\n0.779\n0.733\n0.800\n\n\nInpatient NR-NTX\nNone\nNon-Hispanic White\nVery mild to Moderate Pain\n0.195\n0.178\n0.233\n\n\nInpatient NR-NTX\nNone\nNon-Hispanic White\nSevere Pain\n0.026\n0.022\n0.034\n\n\nInpatient NR-NTX\nNone\nNon-Hispanic Black\nNo Pain\n0.807\n0.788\n0.818\n\n\nInpatient NR-NTX\nNone\nNon-Hispanic Black\nVery mild to Moderate Pain\n0.169\n0.161\n0.186\n\n\nInpatient NR-NTX\nNone\nNon-Hispanic Black\nSevere Pain\n0.023\n0.021\n0.027\n\n\nInpatient NR-NTX\nNone\nHispanic\nNo Pain\n0.828\n0.798\n0.855\n\n\nInpatient NR-NTX\nNone\nHispanic\nVery mild to Moderate Pain\n0.146\n0.124\n0.169\n\n\nInpatient NR-NTX\nNone\nHispanic\nSevere Pain\n0.027\n0.021\n0.033\n\n\nInpatient NR-NTX\nMild\nNon-Hispanic White\nNo Pain\n0.513\n0.408\n0.563\n\n\nInpatient NR-NTX\nMild\nNon-Hispanic White\nVery mild to Moderate Pain\n0.465\n0.419\n0.561\n\n\nInpatient NR-NTX\nMild\nNon-Hispanic White\nSevere Pain\n0.022\n0.018\n0.032\n\n\nInpatient NR-NTX\nMild\nNon-Hispanic Black\nNo Pain\n0.574\n0.501\n0.632\n\n\nInpatient NR-NTX\nMild\nNon-Hispanic Black\nVery mild to Moderate Pain\n0.407\n0.353\n0.474\n\n\nInpatient NR-NTX\nMild\nNon-Hispanic Black\nSevere Pain\n0.020\n0.015\n0.026\n\n\nInpatient NR-NTX\nMild\nHispanic\nNo Pain\n0.599\n0.510\n0.657\n\n\nInpatient NR-NTX\nMild\nHispanic\nVery mild to Moderate Pain\n0.376\n0.324\n0.456\n\n\nInpatient NR-NTX\nMild\nHispanic\nSevere Pain\n0.025\n0.019\n0.034\n\n\nInpatient NR-NTX\nMild\nOther\nNo Pain\n0.447\n0.367\n0.478\n\n\nInpatient NR-NTX\nMild\nOther\nVery mild to Moderate Pain\n0.517\n0.490\n0.586\n\n\nInpatient NR-NTX\nMild\nOther\nSevere Pain\n0.036\n0.032\n0.047\n\n\nInpatient NR-NTX\nModerate\nNon-Hispanic White\nNo Pain\n0.423\n0.357\n0.462\n\n\nInpatient NR-NTX\nModerate\nNon-Hispanic White\nVery mild to Moderate Pain\n0.549\n0.513\n0.608\n\n\nInpatient NR-NTX\nModerate\nNon-Hispanic White\nSevere Pain\n0.028\n0.025\n0.035\n\n\nInpatient NR-NTX\nModerate\nNon-Hispanic Black\nNo Pain\n0.502\n0.428\n0.533\n\n\nInpatient NR-NTX\nModerate\nNon-Hispanic Black\nVery mild to Moderate Pain\n0.474\n0.446\n0.541\n\n\nInpatient NR-NTX\nModerate\nNon-Hispanic Black\nSevere Pain\n0.024\n0.021\n0.031\n\n\nInpatient NR-NTX\nModerate\nHispanic\nNo Pain\n0.520\n0.481\n0.562\n\n\nInpatient NR-NTX\nModerate\nHispanic\nVery mild to Moderate Pain\n0.449\n0.411\n0.483\n\n\nInpatient NR-NTX\nModerate\nHispanic\nSevere Pain\n0.031\n0.026\n0.035\n\n\nInpatient NR-NTX\nModerate\nOther\nNo Pain\n0.352\n0.286\n0.389\n\n\nInpatient NR-NTX\nModerate\nOther\nVery mild to Moderate Pain\n0.602\n0.571\n0.658\n\n\nInpatient NR-NTX\nModerate\nOther\nSevere Pain\n0.046\n0.041\n0.057\n\n\nInpatient NR-NTX\nSevere\nNon-Hispanic White\nNo Pain\n0.203\n0.150\n0.245\n\n\nInpatient NR-NTX\nSevere\nNon-Hispanic White\nVery mild to Moderate Pain\n0.708\n0.678\n0.743\n\n\nInpatient NR-NTX\nSevere\nNon-Hispanic White\nSevere Pain\n0.089\n0.077\n0.107\n\n\nInpatient NR-NTX\nSevere\nNon-Hispanic Black\nNo Pain\n0.221\n0.169\n0.289\n\n\nInpatient NR-NTX\nSevere\nNon-Hispanic Black\nVery mild to Moderate Pain\n0.687\n0.638\n0.722\n\n\nInpatient NR-NTX\nSevere\nNon-Hispanic Black\nSevere Pain\n0.093\n0.074\n0.110\n\n\nInpatient NR-NTX\nSevere\nHispanic\nNo Pain\n0.259\n0.200\n0.298\n\n\nInpatient NR-NTX\nSevere\nHispanic\nVery mild to Moderate Pain\n0.632\n0.606\n0.669\n\n\nInpatient NR-NTX\nSevere\nHispanic\nSevere Pain\n0.109\n0.096\n0.131\n\n\nInpatient NR-NTX\nSevere\nOther\nNo Pain\n0.168\n0.139\n0.184\n\n\nInpatient NR-NTX\nSevere\nOther\nVery mild to Moderate Pain\n0.706\n0.697\n0.721\n\n\nInpatient NR-NTX\nSevere\nOther\nSevere Pain\n0.126\n0.119\n0.140\n\n\nMethadone\nNone\nNon-Hispanic White\nNo Pain\n0.398\n0.325\n0.433\n\n\nMethadone\nNone\nNon-Hispanic White\nVery mild to Moderate Pain\n0.385\n0.370\n0.414\n\n\nMethadone\nNone\nNon-Hispanic White\nSevere Pain\n0.217\n0.197\n0.261\n\n\nMethadone\nNone\nNon-Hispanic Black\nNo Pain\n0.377\n0.359\n0.395\n\n\nMethadone\nNone\nNon-Hispanic Black\nVery mild to Moderate Pain\n0.380\n0.373\n0.387\n\n\nMethadone\nNone\nNon-Hispanic Black\nSevere Pain\n0.243\n0.231\n0.254\n\n\nMethadone\nNone\nHispanic\nNo Pain\n0.371\n0.366\n0.376\n\n\nMethadone\nNone\nHispanic\nVery mild to Moderate Pain\n0.336\n0.335\n0.338\n\n\nMethadone\nNone\nHispanic\nSevere Pain\n0.293\n0.289\n0.296\n\n\nMethadone\nNone\nOther\nNo Pain\n0.302\n0.281\n0.323\n\n\nMethadone\nNone\nOther\nVery mild to Moderate Pain\n0.381\n0.376\n0.387\n\n\nMethadone\nNone\nOther\nSevere Pain\n0.316\n0.301\n0.332\n\n\nMethadone\nMild\nNon-Hispanic White\nNo Pain\n0.167\n0.118\n0.205\n\n\nMethadone\nMild\nNon-Hispanic White\nVery mild to Moderate Pain\n0.675\n0.661\n0.686\n\n\nMethadone\nMild\nNon-Hispanic White\nSevere Pain\n0.147\n0.129\n0.172\n\n\nMethadone\nMild\nNon-Hispanic Black\nNo Pain\n0.179\n0.144\n0.251\n\n\nMethadone\nMild\nNon-Hispanic Black\nVery mild to Moderate Pain\n0.642\n0.618\n0.646\n\n\nMethadone\nMild\nNon-Hispanic Black\nSevere Pain\n0.148\n0.121\n0.162\n\n\nMethadone\nMild\nHispanic\nNo Pain\n0.205\n0.163\n0.272\n\n\nMethadone\nMild\nHispanic\nVery mild to Moderate Pain\n0.600\n0.574\n0.612\n\n\nMethadone\nMild\nHispanic\nSevere Pain\n0.182\n0.150\n0.204\n\n\nMethadone\nMild\nOther\nNo Pain\n0.119\n0.077\n0.159\n\n\nMethadone\nMild\nOther\nVery mild to Moderate Pain\n0.648\n0.632\n0.654\n\n\nMethadone\nMild\nOther\nSevere Pain\n0.213\n0.186\n0.243\n\n\nMethadone\nModerate\nNon-Hispanic White\nNo Pain\n0.117\n0.084\n0.146\n\n\nMethadone\nModerate\nNon-Hispanic White\nVery mild to Moderate Pain\n0.706\n0.700\n0.709\n\n\nMethadone\nModerate\nNon-Hispanic White\nSevere Pain\n0.168\n0.150\n0.191\n\n\nMethadone\nModerate\nNon-Hispanic Black\nNo Pain\n0.131\n0.100\n0.179\n\n\nMethadone\nModerate\nNon-Hispanic Black\nVery mild to Moderate Pain\n0.675\n0.668\n0.679\n\n\nMethadone\nModerate\nNon-Hispanic Black\nSevere Pain\n0.169\n0.144\n0.186\n\n\nMethadone\nModerate\nHispanic\nNo Pain\n0.147\n0.110\n0.186\n\n\nMethadone\nModerate\nHispanic\nVery mild to Moderate Pain\n0.634\n0.625\n0.637\n\n\nMethadone\nModerate\nHispanic\nSevere Pain\n0.209\n0.185\n0.235\n\n\nMethadone\nModerate\nOther\nNo Pain\n0.087\n0.066\n0.109\n\n\nMethadone\nModerate\nOther\nVery mild to Moderate Pain\n0.668\n0.658\n0.673\n\n\nMethadone\nModerate\nOther\nSevere Pain\n0.232\n0.212\n0.254\n\n\nMethadone\nSevere\nNon-Hispanic White\nNo Pain\n0.040\n0.027\n0.050\n\n\nMethadone\nSevere\nNon-Hispanic White\nVery mild to Moderate Pain\n0.613\n0.590\n0.626\n\n\nMethadone\nSevere\nNon-Hispanic White\nSevere Pain\n0.347\n0.324\n0.382\n\n\nMethadone\nSevere\nHispanic\nNo Pain\n0.053\n0.040\n0.063\n\n\nMethadone\nSevere\nHispanic\nVery mild to Moderate Pain\n0.538\n0.523\n0.549\n\n\nMethadone\nSevere\nHispanic\nSevere Pain\n0.410\n0.388\n0.437\n\n\nMethadone\nSevere\nOther\nNo Pain\n0.031\n0.031\n0.031\n\n\nMethadone\nSevere\nOther\nVery mild to Moderate Pain\n0.543\n0.543\n0.543\n\n\nMethadone\nSevere\nOther\nSevere Pain\n0.426\n0.426\n0.426\n\n\nOutpatient BUP\nNone\nNon-Hispanic White\nNo Pain\n0.361\n0.336\n0.389\n\n\nOutpatient BUP\nNone\nNon-Hispanic White\nVery mild to Moderate Pain\n0.407\n0.396\n0.417\n\n\nOutpatient BUP\nNone\nNon-Hispanic White\nSevere Pain\n0.232\n0.215\n0.246\n\n\nOutpatient BUP\nNone\nNon-Hispanic Black\nNo Pain\n0.425\n0.425\n0.425\n\n\nOutpatient BUP\nNone\nNon-Hispanic Black\nVery mild to Moderate Pain\n0.367\n0.367\n0.367\n\n\nOutpatient BUP\nNone\nNon-Hispanic Black\nSevere Pain\n0.208\n0.208\n0.208\n\n\nOutpatient BUP\nNone\nHispanic\nNo Pain\n0.441\n0.385\n0.484\n\n\nOutpatient BUP\nNone\nHispanic\nVery mild to Moderate Pain\n0.319\n0.302\n0.339\n\n\nOutpatient BUP\nNone\nHispanic\nSevere Pain\n0.241\n0.214\n0.276\n\n\nOutpatient BUP\nMild\nNon-Hispanic White\nNo Pain\n0.173\n0.119\n0.211\n\n\nOutpatient BUP\nMild\nNon-Hispanic White\nVery mild to Moderate Pain\n0.680\n0.664\n0.695\n\n\nOutpatient BUP\nMild\nNon-Hispanic White\nSevere Pain\n0.139\n0.122\n0.166\n\n\nOutpatient BUP\nMild\nNon-Hispanic Black\nNo Pain\n0.187\n0.144\n0.272\n\n\nOutpatient BUP\nMild\nNon-Hispanic Black\nVery mild to Moderate Pain\n0.648\n0.612\n0.656\n\n\nOutpatient BUP\nMild\nNon-Hispanic Black\nSevere Pain\n0.141\n0.110\n0.157\n\n\nOutpatient BUP\nMild\nHispanic\nNo Pain\n0.204\n0.153\n0.273\n\n\nOutpatient BUP\nMild\nHispanic\nVery mild to Moderate Pain\n0.608\n0.579\n0.621\n\n\nOutpatient BUP\nMild\nHispanic\nSevere Pain\n0.177\n0.144\n0.204\n\n\nOutpatient BUP\nMild\nOther\nNo Pain\n0.132\n0.093\n0.168\n\n\nOutpatient BUP\nMild\nOther\nVery mild to Moderate Pain\n0.659\n0.652\n0.662\n\n\nOutpatient BUP\nMild\nOther\nSevere Pain\n0.197\n0.174\n0.224\n\n\nOutpatient BUP\nModerate\nNon-Hispanic White\nNo Pain\n0.119\n0.080\n0.152\n\n\nOutpatient BUP\nModerate\nNon-Hispanic White\nVery mild to Moderate Pain\n0.713\n0.704\n0.717\n\n\nOutpatient BUP\nModerate\nNon-Hispanic White\nSevere Pain\n0.161\n0.141\n0.189\n\n\nOutpatient BUP\nModerate\nNon-Hispanic Black\nNo Pain\n0.136\n0.111\n0.181\n\n\nOutpatient BUP\nModerate\nNon-Hispanic Black\nVery mild to Moderate Pain\n0.686\n0.674\n0.688\n\n\nOutpatient BUP\nModerate\nNon-Hispanic Black\nSevere Pain\n0.160\n0.138\n0.174\n\n\nOutpatient BUP\nModerate\nHispanic\nNo Pain\n0.152\n0.114\n0.196\n\n\nOutpatient BUP\nModerate\nHispanic\nVery mild to Moderate Pain\n0.641\n0.628\n0.646\n\n\nOutpatient BUP\nModerate\nHispanic\nSevere Pain\n0.199\n0.172\n0.225\n\n\nOutpatient BUP\nModerate\nOther\nNo Pain\n0.087\n0.061\n0.107\n\n\nOutpatient BUP\nModerate\nOther\nVery mild to Moderate Pain\n0.677\n0.664\n0.681\n\n\nOutpatient BUP\nModerate\nOther\nSevere Pain\n0.225\n0.206\n0.252\n\n\nOutpatient BUP\nSevere\nNon-Hispanic White\nNo Pain\n0.044\n0.033\n0.055\n\n\nOutpatient BUP\nSevere\nNon-Hispanic White\nVery mild to Moderate Pain\n0.628\n0.612\n0.640\n\n\nOutpatient BUP\nSevere\nNon-Hispanic White\nSevere Pain\n0.328\n0.305\n0.355\n\n\nOutpatient BUP\nSevere\nHispanic\nNo Pain\n0.049\n0.049\n0.049\n\n\nOutpatient BUP\nSevere\nHispanic\nVery mild to Moderate Pain\n0.545\n0.545\n0.545\n\n\nOutpatient BUP\nSevere\nHispanic\nSevere Pain\n0.405\n0.405\n0.405\n\n\nOutpatient BUP\nSevere\nOther\nNo Pain\n0.034\n0.034\n0.034\n\n\nOutpatient BUP\nSevere\nOther\nVery mild to Moderate Pain\n0.560\n0.560\n0.560\n\n\nOutpatient BUP\nSevere\nOther\nSevere Pain\n0.405\n0.405\n0.405\n\n\nOutpatient BUP + EMM\nMild\nNon-Hispanic White\nNo Pain\n0.212\n0.149\n0.257\n\n\nOutpatient BUP + EMM\nMild\nNon-Hispanic White\nVery mild to Moderate Pain\n0.639\n0.615\n0.669\n\n\nOutpatient BUP + EMM\nMild\nNon-Hispanic White\nSevere Pain\n0.148\n0.128\n0.182\n\n\nOutpatient BUP + EMM\nMild\nNon-Hispanic Black\nNo Pain\n0.253\n0.213\n0.287\n\n\nOutpatient BUP + EMM\nMild\nNon-Hispanic Black\nVery mild to Moderate Pain\n0.605\n0.586\n0.627\n\n\nOutpatient BUP + EMM\nMild\nNon-Hispanic Black\nSevere Pain\n0.142\n0.128\n0.160\n\n\nOutpatient BUP + EMM\nMild\nHispanic\nNo Pain\n0.287\n0.230\n0.333\n\n\nOutpatient BUP + EMM\nMild\nHispanic\nVery mild to Moderate Pain\n0.546\n0.522\n0.575\n\n\nOutpatient BUP + EMM\nMild\nHispanic\nSevere Pain\n0.167\n0.146\n0.195\n\n\nOutpatient BUP + EMM\nMild\nOther\nNo Pain\n0.179\n0.142\n0.196\n\n\nOutpatient BUP + EMM\nMild\nOther\nVery mild to Moderate Pain\n0.620\n0.615\n0.632\n\n\nOutpatient BUP + EMM\nMild\nOther\nSevere Pain\n0.201\n0.190\n0.226\n\n\nOutpatient BUP + EMM\nModerate\nNon-Hispanic White\nNo Pain\n0.155\n0.107\n0.187\n\n\nOutpatient BUP + EMM\nModerate\nNon-Hispanic White\nVery mild to Moderate Pain\n0.676\n0.662\n0.691\n\n\nOutpatient BUP + EMM\nModerate\nNon-Hispanic White\nSevere Pain\n0.169\n0.150\n0.203\n\n\nOutpatient BUP + EMM\nModerate\nNon-Hispanic Black\nNo Pain\n0.184\n0.156\n0.213\n\n\nOutpatient BUP + EMM\nModerate\nNon-Hispanic Black\nVery mild to Moderate Pain\n0.650\n0.636\n0.662\n\n\nOutpatient BUP + EMM\nModerate\nNon-Hispanic Black\nSevere Pain\n0.167\n0.151\n0.182\n\n\nOutpatient BUP + EMM\nModerate\nHispanic\nNo Pain\n0.200\n0.154\n0.230\n\n\nOutpatient BUP + EMM\nModerate\nHispanic\nVery mild to Moderate Pain\n0.596\n0.585\n0.612\n\n\nOutpatient BUP + EMM\nModerate\nHispanic\nSevere Pain\n0.204\n0.185\n0.234\n\n\nOutpatient BUP + EMM\nModerate\nOther\nNo Pain\n0.107\n0.095\n0.118\n\n\nOutpatient BUP + EMM\nModerate\nOther\nVery mild to Moderate Pain\n0.648\n0.648\n0.648\n\n\nOutpatient BUP + EMM\nModerate\nOther\nSevere Pain\n0.245\n0.234\n0.256\n\n\nOutpatient BUP + EMM\nSevere\nNon-Hispanic White\nNo Pain\n0.056\n0.045\n0.063\n\n\nOutpatient BUP + EMM\nSevere\nNon-Hispanic White\nVery mild to Moderate Pain\n0.596\n0.585\n0.603\n\n\nOutpatient BUP + EMM\nSevere\nNon-Hispanic White\nSevere Pain\n0.348\n0.334\n0.371\n\n\nOutpatient BUP + SMM\nNone\nNon-Hispanic White\nNo Pain\n0.488\n0.488\n0.488\n\n\nOutpatient BUP + SMM\nNone\nNon-Hispanic White\nVery mild to Moderate Pain\n0.334\n0.334\n0.334\n\n\nOutpatient BUP + SMM\nNone\nNon-Hispanic White\nSevere Pain\n0.178\n0.178\n0.178\n\n\nOutpatient BUP + SMM\nNone\nHispanic\nNo Pain\n0.530\n0.530\n0.530\n\n\nOutpatient BUP + SMM\nNone\nHispanic\nVery mild to Moderate Pain\n0.269\n0.269\n0.269\n\n\nOutpatient BUP + SMM\nNone\nHispanic\nSevere Pain\n0.202\n0.202\n0.202\n\n\nOutpatient BUP + SMM\nMild\nNon-Hispanic White\nNo Pain\n0.205\n0.148\n0.251\n\n\nOutpatient BUP + SMM\nMild\nNon-Hispanic White\nVery mild to Moderate Pain\n0.653\n0.627\n0.681\n\n\nOutpatient BUP + SMM\nMild\nNon-Hispanic White\nSevere Pain\n0.142\n0.122\n0.171\n\n\nOutpatient BUP + SMM\nMild\nNon-Hispanic Black\nNo Pain\n0.260\n0.212\n0.304\n\n\nOutpatient BUP + SMM\nMild\nNon-Hispanic Black\nVery mild to Moderate Pain\n0.610\n0.583\n0.638\n\n\nOutpatient BUP + SMM\nMild\nNon-Hispanic Black\nSevere Pain\n0.130\n0.113\n0.150\n\n\nOutpatient BUP + SMM\nMild\nHispanic\nNo Pain\n0.258\n0.187\n0.310\n\n\nOutpatient BUP + SMM\nMild\nHispanic\nVery mild to Moderate Pain\n0.571\n0.544\n0.604\n\n\nOutpatient BUP + SMM\nMild\nHispanic\nSevere Pain\n0.171\n0.146\n0.209\n\n\nOutpatient BUP + SMM\nMild\nOther\nNo Pain\n0.169\n0.157\n0.193\n\n\nOutpatient BUP + SMM\nMild\nOther\nVery mild to Moderate Pain\n0.637\n0.627\n0.641\n\n\nOutpatient BUP + SMM\nMild\nOther\nSevere Pain\n0.195\n0.180\n0.202\n\n\nOutpatient BUP + SMM\nModerate\nNon-Hispanic White\nNo Pain\n0.150\n0.105\n0.179\n\n\nOutpatient BUP + SMM\nModerate\nNon-Hispanic White\nVery mild to Moderate Pain\n0.689\n0.677\n0.704\n\n\nOutpatient BUP + SMM\nModerate\nNon-Hispanic White\nSevere Pain\n0.161\n0.145\n0.192\n\n\nOutpatient BUP + SMM\nModerate\nNon-Hispanic Black\nNo Pain\n0.170\n0.136\n0.200\n\n\nOutpatient BUP + SMM\nModerate\nNon-Hispanic Black\nVery mild to Moderate Pain\n0.667\n0.653\n0.681\n\n\nOutpatient BUP + SMM\nModerate\nNon-Hispanic Black\nSevere Pain\n0.163\n0.147\n0.183\n\n\nOutpatient BUP + SMM\nModerate\nHispanic\nNo Pain\n0.206\n0.200\n0.214\n\n\nOutpatient BUP + SMM\nModerate\nHispanic\nVery mild to Moderate Pain\n0.607\n0.604\n0.610\n\n\nOutpatient BUP + SMM\nModerate\nHispanic\nSevere Pain\n0.187\n0.182\n0.190\n\n\nOutpatient BUP + SMM\nModerate\nOther\nNo Pain\n0.107\n0.088\n0.127\n\n\nOutpatient BUP + SMM\nModerate\nOther\nVery mild to Moderate Pain\n0.662\n0.660\n0.663\n\n\nOutpatient BUP + SMM\nModerate\nOther\nSevere Pain\n0.231\n0.213\n0.250\n\n\nOutpatient BUP + SMM\nSevere\nNon-Hispanic White\nNo Pain\n0.051\n0.049\n0.053\n\n\nOutpatient BUP + SMM\nSevere\nNon-Hispanic White\nVery mild to Moderate Pain\n0.610\n0.607\n0.612\n\n\nOutpatient BUP + SMM\nSevere\nNon-Hispanic White\nSevere Pain\n0.339\n0.335\n0.344\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nImportant\n\n\n\nExtended-release (injected) naltrexone and buprenorphine administered in institutionalized settings were associated to higher probabilities of pain relief. Lower probabilities of pain relief, and smaller differences between treatments were detected in patients with more severe withdrawal symptoms."
  },
  {
    "objectID": "index.html#withdrawal-symptoms",
    "href": "index.html#withdrawal-symptoms",
    "title": "R/Medicine 2024 Data Challenge: Opioid Use Disorder",
    "section": "",
    "text": "When a patient with an addiction tries to stop taking the opioid, he or she may feel the symptoms of withdrawal, which include anxiety, wanting to take the drug again, hyperactivity, being easily agitated, increase in the blood pressure and heart rate, or rapid breathing. Though temporary, opioid withdrawal can be incredibly debilitating.\nIn this section, we performed a predictive model using a multinomial log-linear model to predict the responses on withdrawal symptoms of patients after being treated adjusting by the symptomatology before receiving the treatment and other demographics characteristics such as gender and race. In addition, we compared several models’ fit to ensure we predict the responses using the most exact model.\n\n\n\n# ensuring replicability\nset.seed(19042023)\n\n# Fitting the model with treatment and pre-score predictors\nmod &lt;- multinom(factor(withdrawal_post) ~ treatment + withdrawal_pre, \n                data = data,\n                trace = FALSE)\n\n# Fitting the model with treatment, pre-score, and gender predictors\nmod.1 &lt;- multinom(factor(withdrawal_post) ~ treatment + withdrawal_pre + is_male, data = data,\n                trace = FALSE)\n\n# Fitting the model with treatment, pre-score, gender, and race predictors\nmod.2 &lt;- multinom(factor(withdrawal_post) ~ treatment + withdrawal_pre + is_male + race, \n                  data = data,\n                trace = FALSE)\n\n\n\n\nNext, we are going to compare the fit of the performed models. We used two model fit parameters: the Akaike Information Criterion (AIC) and the deviance. Lower values in both parameters mean a better model fit. Differences in more than 5 points in the AIC is sufficient to rule out the model with the higher AIC value.\n\n## Model fit comparison\ndata.frame(Model = c(\"Model (treat + pre)\",\n                     \"Model (treat + pre + is_male\",\n                     \"Model (treat + pre + is_male + race)\"),\n           AIC = c(mod$AIC, mod.1$AIC, mod.2$AIC),\n           Deviance = c(mod$deviance, mod.1$deviance, mod.2$deviance)) %&gt;%\n  kbl()\n\n\n\n\nModel\nAIC\nDeviance\n\n\n\n\nModel (treat + pre)\n3529.243\n3475.243\n\n\nModel (treat + pre + is_male\n3519.824\n3459.824\n\n\nModel (treat + pre + is_male + race)\n3513.820\n3435.820\n\n\n\n\n\n\n\nThe model with all predictors (i.e., the assigned treatment, the severity of withdrawal symptoms before the treatment, the gender, and the race) outperformed the rest of models. Therefore, we will use it to predict the probability of withdrawal symptoms considering the treatment received and the severity of withdrawal symptoms before treatment adjusted by gender and race.\n\n\n\n\n\nplot_predictions(mod.2, condition = c(\"withdrawal_pre\", \"treatment\"), type = \"probs\") +\n  facet_wrap(~ group,\n             labeller = as_labeller(c(\"0\" = \"Final status: No symptoms\",\n                                      \"1\" = \"Final status: Mild symptoms\",\n                                      \"2\" = \"Final status: Moderate symptoms\",\n                                      \"3\" = \"Final status: Severe symptoms\"))) +\n  labs(x = \"Withdrawal symptoms before the treatment\",\n       y = \"Probability of achieving the final status after treatment\",\n       col = \"Treatment\") +\n  theme_dark() +\n  scale_color_viridis_d(option = \"H\") +\n  scale_x_discrete(labels = c(\"None\",\n                              \"Mild\",\n                              \"Moderate\",\n                              \"Severe\")) +\n  theme(legend.position = \"bottom\",\n        legend.box = \"vertical\")\n\n\n\n\n(a) Notes. BUP: Buprenorphine; NR-NTX: Extended-release Naltrexone; SMM: Standard Medical Management; EMM: Enhanced Medical Management (SMM + Indivdual Drug Counselling).\n\n\n\nFigure 2: Predictions for withdrawal symptoms severity adjusted by gender, self-reported race, and withdrawal symptoms before treatment.\n\n\nIn Figure 2 we can observe the treatment predicted responses to withdrawal symptoms. The treatments showing the highest probability of no withdrawal symptoms after treatment regardless the associated symptoms before treatment involvement were those based on Outpatient Buprenorphine + Enhanced Medical Management (defined as Standard Medical Management plus Individual Drug Counselling) and Outpatient Buprenorphine + Standard Medical Management. For example, a person who suffered severe opiod withdrawal symptoms before treatment and received Outpatient Buprenorphine + EMM had a probability of 0.693 (95% CI 0.658 to 0.716) of total withdrawal symptoms recovery. Comparably, if the same person would receive Methadone or isolated Outpatient Buprenorphine (i.e., no EMM or SMM), he/she would have probabilities of no withdrawal symptoms of 0.279 (95% CI 0.218 to 0.412), and 0.231 (95% CI 0.171 to 0.329), respectively. Evidence showing different characteristics associated to outpatient and inpatient settings suggests that outpatients can be favored for controlling withdrawal symptoms (Varney et al. 2021). In addition, inpatient treatments resulted in less effective interventions, achieving a potential reduction of severe symptoms, but with a very low probability of total withdrawal symptoms recovery. Naltrexone presented more benefits than buprenorphine in inpatients for withdrawal symptoms. Evidence supports this finding showing that naltrexone is an opioid antagonist, meaning that it works differently than methadone and buprenorphine to treat OUD by blocking opioid receptor activity (Varney et al. 2021). Numerical values are presented in Table 2.\n\npredictions(mod.2) %&gt;%\n  group_by(treatment, withdrawal_pre, group) %&gt;%\n  mean_qi(estimate) %&gt;% \n  as.data.frame() %&gt;% \n  mutate(withdrawal_pre = case_when(\n    withdrawal_pre == \"0\" ~ \"No symptoms\",\n    withdrawal_pre == \"1\" ~ \"Mild symptoms\",\n    withdrawal_pre == \"2\" ~ \"Moderate symptoms\",\n    withdrawal_pre == \"3\" ~ \"Severe symptoms\"\n  ),\n  group = case_when(\n    group == \"0\" ~ \"No symptoms\",\n    group == \"1\" ~ \"Mild symptoms\",\n    group == \"2\" ~ \"Moderate symptoms\",\n    group == \"3\" ~ \"Severe symptoms\"\n  )) %&gt;%\n  rename(Treatment = treatment,\n         `Symptoms before\\ntreatment` = withdrawal_pre,\n         `Symptoms after\\ntreatment` = group,\n         Probability = estimate,\n         `95% lower bound` = .lower,\n         `95% upper bound` = .upper) %&gt;%\n  select(Treatment, `Symptoms before\\ntreatment`,\n         `Symptoms after\\ntreatment`, Probability, \n         `95% lower bound`, `95% upper bound`) %&gt;%\n  mutate_if(is.numeric, round, 3) %&gt;%\n  kbl()\n\n\nTable 2: Table 2. Predicted probabilities of withdrawal symptoms after treatment.\n\n\n\n\n(a) Notes. 95% CI corresponds to the 95% confidence interval of the predicted probability.\n\n\nTreatment\nSymptoms before treatment\nSymptoms after treatment\nProbability\n95% lower bound\n95% upper bound\n\n\n\n\nInpatient BUP\nNo symptoms\nNo symptoms\n0.343\n0.334\n0.352\n\n\nInpatient BUP\nNo symptoms\nMild symptoms\n0.584\n0.565\n0.602\n\n\nInpatient BUP\nNo symptoms\nModerate symptoms\n0.074\n0.064\n0.084\n\n\nInpatient BUP\nNo symptoms\nSevere symptoms\n0.000\n0.000\n0.000\n\n\nInpatient BUP\nMild symptoms\nNo symptoms\n0.144\n0.101\n0.225\n\n\nInpatient BUP\nMild symptoms\nMild symptoms\n0.737\n0.661\n0.784\n\n\nInpatient BUP\nMild symptoms\nModerate symptoms\n0.094\n0.063\n0.146\n\n\nInpatient BUP\nMild symptoms\nSevere symptoms\n0.026\n0.020\n0.036\n\n\nInpatient BUP\nModerate symptoms\nNo symptoms\n0.057\n0.040\n0.095\n\n\nInpatient BUP\nModerate symptoms\nMild symptoms\n0.646\n0.571\n0.716\n\n\nInpatient BUP\nModerate symptoms\nModerate symptoms\n0.187\n0.120\n0.251\n\n\nInpatient BUP\nModerate symptoms\nSevere symptoms\n0.110\n0.091\n0.166\n\n\nInpatient BUP\nSevere symptoms\nNo symptoms\n0.028\n0.018\n0.046\n\n\nInpatient BUP\nSevere symptoms\nMild symptoms\n0.429\n0.365\n0.482\n\n\nInpatient BUP\nSevere symptoms\nModerate symptoms\n0.240\n0.173\n0.329\n\n\nInpatient BUP\nSevere symptoms\nSevere symptoms\n0.303\n0.264\n0.394\n\n\nInpatient NR-NTX\nNo symptoms\nNo symptoms\n0.539\n0.479\n0.657\n\n\nInpatient NR-NTX\nNo symptoms\nMild symptoms\n0.438\n0.326\n0.481\n\n\nInpatient NR-NTX\nNo symptoms\nModerate symptoms\n0.023\n0.016\n0.041\n\n\nInpatient NR-NTX\nNo symptoms\nSevere symptoms\n0.000\n0.000\n0.000\n\n\nInpatient NR-NTX\nMild symptoms\nNo symptoms\n0.268\n0.197\n0.389\n\n\nInpatient NR-NTX\nMild symptoms\nMild symptoms\n0.693\n0.581\n0.755\n\n\nInpatient NR-NTX\nMild symptoms\nModerate symptoms\n0.032\n0.021\n0.051\n\n\nInpatient NR-NTX\nMild symptoms\nSevere symptoms\n0.007\n0.006\n0.013\n\n\nInpatient NR-NTX\nModerate symptoms\nNo symptoms\n0.125\n0.099\n0.210\n\n\nInpatient NR-NTX\nModerate symptoms\nMild symptoms\n0.758\n0.667\n0.802\n\n\nInpatient NR-NTX\nModerate symptoms\nModerate symptoms\n0.077\n0.046\n0.109\n\n\nInpatient NR-NTX\nModerate symptoms\nSevere symptoms\n0.040\n0.031\n0.070\n\n\nInpatient NR-NTX\nSevere symptoms\nNo symptoms\n0.080\n0.057\n0.136\n\n\nInpatient NR-NTX\nSevere symptoms\nMild symptoms\n0.645\n0.542\n0.698\n\n\nInpatient NR-NTX\nSevere symptoms\nModerate symptoms\n0.137\n0.086\n0.189\n\n\nInpatient NR-NTX\nSevere symptoms\nSevere symptoms\n0.137\n0.115\n0.211\n\n\nMethadone\nNo symptoms\nNo symptoms\n0.826\n0.778\n0.889\n\n\nMethadone\nNo symptoms\nMild symptoms\n0.166\n0.107\n0.209\n\n\nMethadone\nNo symptoms\nModerate symptoms\n0.008\n0.004\n0.014\n\n\nMethadone\nNo symptoms\nSevere symptoms\n0.000\n0.000\n0.000\n\n\nMethadone\nMild symptoms\nNo symptoms\n0.563\n0.477\n0.706\n\n\nMethadone\nMild symptoms\nMild symptoms\n0.421\n0.285\n0.502\n\n\nMethadone\nMild symptoms\nModerate symptoms\n0.016\n0.008\n0.026\n\n\nMethadone\nMild symptoms\nSevere symptoms\n0.001\n0.000\n0.001\n\n\nMethadone\nModerate symptoms\nNo symptoms\n0.354\n0.284\n0.513\n\n\nMethadone\nModerate symptoms\nMild symptoms\n0.595\n0.456\n0.657\n\n\nMethadone\nModerate symptoms\nModerate symptoms\n0.047\n0.027\n0.072\n\n\nMethadone\nModerate symptoms\nSevere symptoms\n0.004\n0.003\n0.006\n\n\nMethadone\nSevere symptoms\nNo symptoms\n0.279\n0.218\n0.412\n\n\nMethadone\nSevere symptoms\nMild symptoms\n0.595\n0.494\n0.652\n\n\nMethadone\nSevere symptoms\nModerate symptoms\n0.109\n0.063\n0.151\n\n\nMethadone\nSevere symptoms\nSevere symptoms\n0.018\n0.013\n0.025\n\n\nOutpatient BUP\nNo symptoms\nNo symptoms\n0.770\n0.730\n0.788\n\n\nOutpatient BUP\nNo symptoms\nMild symptoms\n0.204\n0.186\n0.231\n\n\nOutpatient BUP\nNo symptoms\nModerate symptoms\n0.026\n0.020\n0.040\n\n\nOutpatient BUP\nNo symptoms\nSevere symptoms\n0.000\n0.000\n0.000\n\n\nOutpatient BUP\nMild symptoms\nNo symptoms\n0.539\n0.444\n0.682\n\n\nOutpatient BUP\nMild symptoms\nMild symptoms\n0.409\n0.289\n0.488\n\n\nOutpatient BUP\nMild symptoms\nModerate symptoms\n0.051\n0.029\n0.087\n\n\nOutpatient BUP\nMild symptoms\nSevere symptoms\n0.001\n0.001\n0.001\n\n\nOutpatient BUP\nModerate symptoms\nNo symptoms\n0.305\n0.242\n0.468\n\n\nOutpatient BUP\nModerate symptoms\nMild symptoms\n0.543\n0.436\n0.598\n\n\nOutpatient BUP\nModerate symptoms\nModerate symptoms\n0.146\n0.089\n0.213\n\n\nOutpatient BUP\nModerate symptoms\nSevere symptoms\n0.005\n0.004\n0.008\n\n\nOutpatient BUP\nSevere symptoms\nNo symptoms\n0.231\n0.171\n0.329\n\n\nOutpatient BUP\nSevere symptoms\nMild symptoms\n0.503\n0.433\n0.556\n\n\nOutpatient BUP\nSevere symptoms\nModerate symptoms\n0.247\n0.190\n0.352\n\n\nOutpatient BUP\nSevere symptoms\nSevere symptoms\n0.018\n0.016\n0.024\n\n\nOutpatient BUP + EMM\nMild symptoms\nNo symptoms\n0.883\n0.862\n0.935\n\n\nOutpatient BUP + EMM\nMild symptoms\nMild symptoms\n0.114\n0.063\n0.133\n\n\nOutpatient BUP + EMM\nMild symptoms\nModerate symptoms\n0.003\n0.001\n0.005\n\n\nOutpatient BUP + EMM\nMild symptoms\nSevere symptoms\n0.000\n0.000\n0.000\n\n\nOutpatient BUP + EMM\nModerate symptoms\nNo symptoms\n0.757\n0.731\n0.834\n\n\nOutpatient BUP + EMM\nModerate symptoms\nMild symptoms\n0.228\n0.153\n0.248\n\n\nOutpatient BUP + EMM\nModerate symptoms\nModerate symptoms\n0.015\n0.008\n0.021\n\n\nOutpatient BUP + EMM\nModerate symptoms\nSevere symptoms\n0.000\n0.000\n0.000\n\n\nOutpatient BUP + EMM\nSevere symptoms\nNo symptoms\n0.693\n0.658\n0.716\n\n\nOutpatient BUP + EMM\nSevere symptoms\nMild symptoms\n0.270\n0.257\n0.289\n\n\nOutpatient BUP + EMM\nSevere symptoms\nModerate symptoms\n0.037\n0.026\n0.053\n\n\nOutpatient BUP + EMM\nSevere symptoms\nSevere symptoms\n0.000\n0.000\n0.000\n\n\nOutpatient BUP + SMM\nNo symptoms\nNo symptoms\n0.952\n0.952\n0.952\n\n\nOutpatient BUP + SMM\nNo symptoms\nMild symptoms\n0.047\n0.047\n0.047\n\n\nOutpatient BUP + SMM\nNo symptoms\nModerate symptoms\n0.001\n0.001\n0.001\n\n\nOutpatient BUP + SMM\nNo symptoms\nSevere symptoms\n0.000\n0.000\n0.000\n\n\nOutpatient BUP + SMM\nMild symptoms\nNo symptoms\n0.858\n0.838\n0.923\n\n\nOutpatient BUP + SMM\nMild symptoms\nMild symptoms\n0.136\n0.075\n0.153\n\n\nOutpatient BUP + SMM\nMild symptoms\nModerate symptoms\n0.006\n0.002\n0.009\n\n\nOutpatient BUP + SMM\nMild symptoms\nSevere symptoms\n0.000\n0.000\n0.000\n\n\nOutpatient BUP + SMM\nModerate symptoms\nNo symptoms\n0.725\n0.690\n0.844\n\n\nOutpatient BUP + SMM\nModerate symptoms\nMild symptoms\n0.253\n0.147\n0.278\n\n\nOutpatient BUP + SMM\nModerate symptoms\nModerate symptoms\n0.023\n0.009\n0.032\n\n\nOutpatient BUP + SMM\nModerate symptoms\nSevere symptoms\n0.000\n0.000\n0.000\n\n\nOutpatient BUP + SMM\nSevere symptoms\nNo symptoms\n0.606\n0.606\n0.606\n\n\nOutpatient BUP + SMM\nSevere symptoms\nMild symptoms\n0.316\n0.316\n0.316\n\n\nOutpatient BUP + SMM\nSevere symptoms\nModerate symptoms\n0.079\n0.079\n0.079\n\n\nOutpatient BUP + SMM\nSevere symptoms\nSevere symptoms\n0.000\n0.000\n0.000\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFortunately, longitudinal registers of withdrawal symptoms are also collected. These data can help us to understand how opioid withdrawal symptoms fluctuate across time depending on the treatment and dose administered.\n\n\nTo model these data, we used a generalized additive model (GAM), which can capture non-linear patterns, and are particularly valuable when investigating intricate dependencies (e.g., across time). First and foremost, we generated the dataset.\n\n# Generating the dataset containing longitudinal registers for withdrawal symptoms\ngam_data &lt;- treatment %&gt;%\n  left_join(withdrawal, by = c(\"who\", \"when\")) %&gt;%\n  left_join(data %&gt;%\n              select(who, treatment, is_male, race))\n\n# Setting a seed for replicability\nset.seed(123)\n\n# fitting a generalized additive model (GAM) adjusting by treatment-dose interaction\nmodel &lt;- bam(withdrawal ~ treatment:amount + s(when, by = treatment) + s(who, bs = \"re\"),\n             data = gam_data %&gt;% mutate(withdrawal = as.numeric(withdrawal)),\n             family = gaussian())\n\n# computing predictions\npred_gam &lt;- predictions(model)\n\nClinicians can gain advantage of these results optimizing the dose needed to alleviate those symptoms, pruning the probability of potential overdose cases. In Figure 3, it can be observed that methadone administered in higher doses (e.g., 50 mg/day) did not show improvements in the first 10 days. Comparably, higher doses of buprenorphine in inpatients did not show benefits on withdrawal symptoms compared to lower doses, which reduced the severity of these symptoms. Injected naltrexone on inpatients presented a reduction in withdrawal symptoms up to three months after treatment beginning. Higher doses of buprenorphine in outpatients can be related to patients with more severe additions, and thus, more severe withdrawal symptoms; so, it can be beneficial for those patients to receive medically-controlled prescribed higher doses. Conversely, when buprenorphine is administered to outpatients combined with EMM or SMM, higher doses were associated with benefits on those symptoms.\n\n\n# plot\npred_gam %&gt;%\n  group_by(treatment, amount, when) %&gt;%\n  mean_qi(estimate) %&gt;% \n  mutate(estimate_class = case_when(\n    estimate &lt; 0.5 ~ \"None\",\n    estimate &gt;= 0.5 & estimate &lt; 1.5 ~ \"Mild\",\n    estimate &gt;= 1.5 & estimate &lt; 2.5 ~ \"Moderate\",\n    estimate &gt;= 2.5 ~ \"Severe\"\n  )) %&gt;%\n  ggplot(aes(x = when, y = amount, z = estimate)) +\n  geom_tile(aes(fill = estimate_class)) +\n  facet_wrap(~ treatment, scales = \"free_x\") +\n  labs(x = \"Time (days)\",\n       y = \"Doses (mg of administered drug)\",\n       fill = \"Withdrawal symptoms\") +\n  theme_dark() +\n  scale_fill_manual(values = c(\"Mild\" = \"yellow\",\n                               \"Moderate\" = \"orange\",\n                               \"Severe\" = \"red\")) +\n  theme(legend.position = \"bottom\",\n        legend.box = \"vertical\") +\n  scale_y_continuous(breaks = c(1, seq(10, 60, 10)),\n                     labels = c(\"Injected\", seq(10, 60, 10)))\n\n\n\n\n(a) Notes. BUP: Buprenorphine; NR-NTX: Extended-release Naltrexone; SMM: Standard Medical Management; EMM: Enhanced Medical Management (SMM + Indivdual Drug Counselling).\n\n\n\nFigure 3: Withdrawal symptoms across time for different doses of the analyzed treatments.\n\n\n\n\n\n\n\n\nImportant\n\n\n\nBuprenorphine + EMM or SMM was the most beneficial for alleviating withdrawal symptoms in outpatients. For inpatients, injectable naltrexone seems to be a better option to face withdrawal symptoms than methadone. More doses have not to be necessarily associated with better outcomes, which should be carefully prescribed."
  },
  {
    "objectID": "index.html#adherence-rate",
    "href": "index.html#adherence-rate",
    "title": "R/Medicine 2024 Data Challenge: Opioid Use Disorder",
    "section": "",
    "text": "After predicting the most beneficial treatments for alleviating withdrawal symptoms, it is needed to analyze which of them have associated the lowest attrition rate (i.e., the highest adherence to the treatment), since it is a key factor to achieve the predicted effectiveness. Currently, adherence to and retention in medications for OUD (i.e., the continuous engagement in treatment) is incompletely understood by healthcare professionals (Viera et al. 2020). Several factors at the individual, interpersonal, and institutional levels have been associated to OUD treatments; among them, OUD treatment dosage, which will be analyzed in the next section.\n\n\nBased on previous exploratory data analyses, we conducted a linear model to predict adherence rates using the assigned treatment, the race of the participant, and the withdrawal symptoms before receiving the assigned treatment.\n\n# Setting a seed for replicability\nset.seed(123)\n\n# Fitting the model\nmodel_ad &lt;- lm(perc ~ treatment + race + withdrawal_pre, data = data %&gt;% filter(!is.na(withdrawal_pre)))\n\n# Summary of the model\nsummary(model_ad)\n\n\nCall:\nlm(formula = perc ~ treatment + race + withdrawal_pre, data = data %&gt;% \n    filter(!is.na(withdrawal_pre)))\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.63716 -0.26443  0.06062  0.24340  0.51987 \n\nCoefficients:\n                              Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)                    0.48978    0.04708  10.404  &lt; 2e-16 ***\ntreatmentInpatient NR-NTX     -0.13187    0.02540  -5.192 2.26e-07 ***\ntreatmentMethadone             0.12200    0.02297   5.312 1.19e-07 ***\ntreatmentOutpatient BUP       -0.05674    0.02178  -2.604  0.00926 ** \ntreatmentOutpatient BUP + EMM -0.07874    0.02490  -3.163  0.00158 ** \ntreatmentOutpatient BUP + SMM -0.04556    0.02499  -1.823  0.06838 .  \nraceNon-Hispanic Black        -0.01743    0.02207  -0.790  0.42966    \nraceHispanic                  -0.03737    0.01816  -2.058  0.03970 *  \nraceOther                     -0.03985    0.02674  -1.490  0.13632    \nwithdrawal_pre1                0.10538    0.04485   2.349  0.01889 *  \nwithdrawal_pre2                0.08688    0.04523   1.921  0.05486 .  \nwithdrawal_pre3                0.08376    0.04916   1.704  0.08854 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.286 on 2330 degrees of freedom\n  (238 observations deleted due to missingness)\nMultiple R-squared:  0.07712,   Adjusted R-squared:  0.07277 \nF-statistic:  17.7 on 11 and 2330 DF,  p-value: &lt; 2.2e-16\n\n\n\n\n\nTo ease the interpretation of the model, these numbers displayed help us to predict the adherence rate of a participant with specific characteristics. For example, we can predict the adherence rate of a non-hispanic black participant who were assigned to the “Inpatient BUP” treatment with severe withdrawal symptoms.\n\n# Prediction model\nprediction &lt;- predict(model_ad, newdata = tibble(race = \"Non-Hispanic Black\",\n                                       treatment = \"Inpatient BUP\",\n                                       withdrawal_pre = \"3\")) %&gt;% as.numeric()\n\n# Result\npaste(\"The predicted adherence rate for a non-Hispanic black participant with severe withdrawal symptoms assigned to the Inpatient BUP treatment is \", round(prediction, 2) * 100, \"%\", sep = \"\")\n## [1] \"The predicted adherence rate for a non-Hispanic black participant with severe withdrawal symptoms assigned to the Inpatient BUP treatment is 56%\"\n\nWe can see that if the same person would be assigned to another treatment (e.g., “Methadone”), the adherence rate would be different.\n\n# Prediction model\nprediction &lt;- predict(model_ad, newdata = tibble(race = \"Non-Hispanic Black\",\n                                       treatment = \"Methadone\",\n                                       withdrawal_pre = \"3\")) %&gt;% as.numeric()\n\n# Result\npaste(\"The predicted adherence rate for a non-Hispanic black participant with severe withdrawal symptoms assigned to the Inpatient BUP treatment is \", round(prediction, 2) * 100, \"%\", sep = \"\")\n## [1] \"The predicted adherence rate for a non-Hispanic black participant with severe withdrawal symptoms assigned to the Inpatient BUP treatment is 68%\"\n\nIn Figure 4, we can observe the variability in the adherence rate considering which treatment they received, and the withdrawal symptoms they experienced before treatment. Methadone showed really good adherence rates followed by the buprenorphine administered in participants who were institutionalized. It is an interesting finding, since we previously found that buprenorphine + EMM or SMM were the most effective interventions to reduce withdrawal symptoms; however, the adherence to the treatment is one of the most important factors to consider when a clinician prescribes a specific treatment in OUD patients. Therefore, it seems that methadone is one of the best treatments that showed a valuable trade-off between effectiveness and patient adherence. Additionally, patients that suffered from withdrawal symptoms regardless the severity of them had associated more adherence rates than patients with no symptoms. That could be explained by the need of people suffering withdrawal symptoms to alleviate these symptoms with treatment drugs.\n\n# data frame for prediction\nnewdata &lt;- expand.grid(race = unique(data$race),\n                       treatment = unique(data$treatment),\n                       withdrawal_pre = unique(data$withdrawal_pre)) %&gt;% \n  drop_na()\n\n# predictions \npred &lt;- predict(model_ad, newdata)\n\n\n\n# plotting predictions\nnewdata %&gt;% cbind(pred) %&gt;%\n  mutate(treatment = reorder(treatment, pred)) %&gt;%\n  ggplot(aes(y = pred, x = withdrawal_pre)) +\n  stat_pointinterval(aes(col = treatment),\n                     position = position_dodge(width = 0.3)) +\n  theme_dark() +\n  scale_color_viridis_d(option = \"H\") +\n  scale_x_discrete(labels = c(\"None\",\n                              \"Mild\",\n                              \"Moderate\",\n                              \"Severe\")) +\n  theme(legend.position = \"bottom\",\n        legend.box = \"vertical\") +\n  labs(x = \"Withdrawal symptoms before treatment\",\n       y = \"Probability of predicted adherence rate (attended sessions)\",\n       col = \"Treatment\") +\n  scale_y_continuous(breaks = seq(0.2, 1, 0.05))\n\n\n\n\n(a) Notes. BUP: Buprenorphine; NR-NTX: Extended-release Naltrexone; SMM: Standard Medical Management; EMM: Enhanced Medical Management (SMM + Indivdual Drug Counselling).\n\n\n\nFigure 4: Predictions for adherence rates in the analyzed treatments adjusting by different severity degress of withdrawal symptoms before treatment.\n\n\n\n\n\nAs we stated in the previous section, medication dosage can play a role in the treatment adherence. Therefore, we used the longitudinal dataset previously created to predict the adherence to the assigned treatment depending on the median dose that patients received.\n\n\n\n# linear model\nad.model.gam &lt;- gam_data %&gt;% group_by(who) %&gt;% median_qi(amount) %&gt;%\n  select(who, amount) %&gt;%\n  full_join(data, by = \"who\") %&gt;%\n  lm(perc ~ treatment:amount + withdrawal_pre + per_day, data = .) # model with best fit\n\n\n\n\nPercentage of adherence to the assigned treatment is shown in Figure 5. Medication dosage has a great influence on the treatment adherence regardless withdrawal symptoms before treatment, with higher doses associated with higher adherence. Administering the same dose in oral-consumed treatments, buprenorphine showed more adherence rates compared to methadone in outpatients. However, 60 mg/day of methadone was associated with the greatest treatment adherence rate. Injectable nalextrone achieved a considerable adherence rate in inpatients. As we have already detected, patients with no withdrawal symptoms had associated lower treatment adherence rates.\n\n\n# plotting the predictions\nmarginaleffects::predictions(ad.model.gam, \n                             newdata = datagrid(treatment = unique(data$treatment),\n                                                              amount = c(1, 10, 20, 30, 40, 50, 60),\n                                                              withdrawal_pre = unique(data$withdrawal_pre),\n                                                              per_day = unique(data$per_day)[c(1, 2, 4)])) %&gt;% \n  as.data.frame() %&gt;% \n  drop_na() %&gt;% \n  \n  # validating only approved doses of medications\n  mutate(check = case_when(\n    treatment == \"Inpatient NR-NTX\" & amount &gt; 1 ~ 1,\n    treatment %in% c(\"Inpatient BUP\",\n                     \"Outpatient BUP\",\n                     \"Outpatient BUP + EMM\",\n                     \"Outpatient BUP + SMM\") & amount &gt; 30 ~ 1,\n    TRUE ~ 0)) %&gt;%\n  filter(check == 0) %&gt;%\n  group_by(treatment, amount, withdrawal_pre) %&gt;%\n  mean_qi(estimate) %&gt;%\n  arrange(estimate) %&gt;%\n  ggplot(aes(x = amount, y = estimate)) +\n  geom_pointinterval(aes(col = withdrawal_pre,\n                         ymin = .lower, ymax = .upper),\n                     position = position_dodge(width = 5.5)) +\n  facet_wrap(~ treatment) +\n  labs(x = \"Dose (mg of administered drug)\",\n       y = \"Percentage of adherence to the assigned treatment\",\n       col = \"Withdrawal symptoms\") +\n  theme_dark() +\n  scale_color_viridis_d(option = \"H\",\n                        labels = c(\"None\",\n                                   \"Mild\",\n                                   \"Moderate\",\n                                   \"Severe\")) +\n  scale_y_continuous(breaks = seq(0.1, 1, 0.1),\n                     labels = scales::label_percent(),\n                     limits = c(0.3, 0.95)) +\n  scale_x_continuous(breaks = c(1, 10, 20, 30, 40, 50, 60),\n                     labels = c(\"1 or\\nInjected\", 10, 20, 30, 40, 50, 60)) +\n  theme(legend.position = \"bottom\",\n        legend.box = \"vertical\")\n\n\n\n\n(a) Notes. BUP: Buprenorphine; NR-NTX: Extended-release Naltrexone; SMM: Standard Medical Management; EMM: Enhanced Medical Management (SMM + Indivdual Drug Counselling). Injected drugs were only used in inpatients (i.e., buprenorphine and naltrexone).\n\n\n\nFigure 5: Predictions for adherence rates adjusted by drug dosage and withdrawal symptoms before treatment for the analyzed treatments.\n\n\n\n\n\n\n\n\nImportant\n\n\n\nMethadone was associated with the highest treatment adherence rates. Higher doses were associated with higher rates of treatment adherence. Administering a similar dose, buprenorphine also showed good adherence rates for outpatients and inpatients."
  },
  {
    "objectID": "index.html#combining-evidence-on-adherence-effectiveness-on-withdrawal-symptoms-and-pain-guiding-treatment-selection",
    "href": "index.html#combining-evidence-on-adherence-effectiveness-on-withdrawal-symptoms-and-pain-guiding-treatment-selection",
    "title": "R/Medicine 2024 Data Challenge: Opioid Use Disorder",
    "section": "",
    "text": "While a large proportion of people with OUD return to consume at some point in their lives, the risk of death is mitigated by remaining in treatment. Moreover, the predicted effectiveness of the different analyzed treatments can vary if patients would not attend approximately half of the programmed visits (predictions were computed averaging the percentage of adherence rates = 44.06%). Thus, healthcare professionals should consider the mean adherence rate of the treatment of interest and its effectiveness on withdrawal symptoms alleviation, and pain relief when prescribing specific treatments for OUD patients. Therefore, when two treatments achieve similar effectiveness on an outcome of interest (e.g., after the initial physical and historical patient examination, it is possible that the main outcome that should be treated would be opioid withdrawal symptoms), the treatment that has associated higher adherence rates should be selected, and vice versa (i.e., if two treatments achieve similar adherence, the treatment predicted as the most beneficial should be selected). For a global vision of the main concerns in OUD patients, we present the Figure 6.\n\n\nFor adherence rates, we have just predicted outcomes following our linear model. For pain levels, we predicted the probabilities for the analyzed treatments to achieve a total pain relief (i.e., outcome = No Pain). For opioid withdrawal symptoms, we predicted for each level of severity (i.e., 0 = None; 1 = Mild; 2 = Moderate; 3 = Severe) only the probabilities to alleviate the symptoms that existed before treatment (e.g., if a patient suffered moderate withdrawal symptoms, the probabilities of achieve mild or any symptoms).\n\n# adherence rate data\nadherence.data &lt;- newdata %&gt;% \n  cbind(pred) %&gt;%\n  group_by(treatment, withdrawal_pre) %&gt;%\n  mean_qi(pred) %&gt;%\n  select(treatment, withdrawal_pre, pred, .lower, .upper) %&gt;%\n  rename(adherence = pred,\n         ad.lower = .lower,\n         ad.upper = .upper)\n\n# pain data\npain.data &lt;- marginaleffects::predictions(model.1) %&gt;% \n  as.data.frame() %&gt;%\n  filter(group != \"Missing\") %&gt;%\n  mutate(group = factor(group, levels = c(\"No Pain\",\n                                          \"Very mild to Moderate Pain\",\n                                          \"Severe Pain\"))) %&gt;%\n  group_by(treatment, withdrawal_pre, group) %&gt;%\n  mean_qi(estimate) %&gt;%\n  as.data.frame() %&gt;%\n  mutate(treatment = reorder(treatment, estimate)) %&gt;%\n  \n  # only conserve data related to 'no pain' outcomes\n  filter(group == \"No Pain\") %&gt;%\n  select(treatment, withdrawal_pre, estimate, .lower, .upper)\n\n\n\n# withdrawal effectiveness data\nwithd.data &lt;- predictions(mod.2) %&gt;%\n  group_by(treatment, withdrawal_pre, group) %&gt;%\n  mean_qi(estimate) %&gt;%\n  as.data.frame() %&gt;%\n  \n  # only conserve data correspond to withdrawal symptoms improvement\n  mutate(valid = case_when(\n    withdrawal_pre == 0 & group == 0 ~ 1,\n    withdrawal_pre == 1 & group == 0 ~ 1,\n    withdrawal_pre == 2 & group %in% c(0, 1) ~ 1,\n    withdrawal_pre == 3 & group %in% c(0, 1, 2) ~ 1,\n    TRUE ~ 0\n  )) %&gt;%\n  filter(valid == 1) %&gt;%\n  group_by(treatment, withdrawal_pre) %&gt;%\n  mean_qi(estimate) %&gt;%\n  select(treatment, withdrawal_pre, estimate, .lower, .upper) %&gt;%\n  rename(effectiveness = estimate, \n         ef.lower = .lower,\n         ef.upper = .upper)\n\n\n# combining predictions of the outcomes of interest\nfinal.data &lt;- adherence.data %&gt;% \n  full_join(withd.data, by = c(\"treatment\", \"withdrawal_pre\")) %&gt;%\n  full_join(pain.data, by = c(\"treatment\", \"withdrawal_pre\")) %&gt;%\n  mutate(withdrawal_pre = factor(withdrawal_pre,\n                                 levels = c(\"0\", \"1\", \"2\", \"3\"),\n                                 labels = c(\"None\",\n                                            \"Mild\", \n                                            \"Moderate\",\n                                            \"Severe\"))) %&gt;%\n  rename(`Withdrawal symptoms before treatment` = withdrawal_pre)\n\n\n\n\nTo ease the understanding of the Figure 6, you have to take into account:\n\nYou can stop the animation to observe the results for the treatment of interest for patients with specific withdrawal symptoms severity.\nIf you are not able to observe an axis title, you can rotate the figure.\nEach treatment has associated a specific color.\nYou can freely move the slider to observe the results for a determined withdrawal symptoms’ severity.\nIf you put your mouse over a point, the results for this point are displayed considering that axis x corresponds to the adherence rate, y axis refers to withdrawal symptoms’ improvement, and z axis corresponds to pain relief outcomes.\n\n\n# plot\nplot_ly(final.data,\n        x = ~adherence, y = ~effectiveness, z = ~estimate,\n        color = ~treatment,\n        frame = ~`Withdrawal symptoms before treatment`,\n        mode = \"markers\",\n        type = \"scatter3d\") %&gt;%\n  layout(scene = list(xaxis = list(title = \"Adherence\"),\n                      yaxis = list(title = \"Withdrawal symptoms improvement\"),\n                      zaxis = list(title = \"Pain relief\"))) %&gt;%\n  animation_opts(frame = 3000, easing = \"elastic\", redraw = TRUE) %&gt;%\n  animation_slider(currentvalue = list(prefix = \"Withdrawal symptoms before treatment: \",\n                                       font = list(color = \"red\")))\n\n\n\n\nFigure 6: Evidence on adherence, withdrawal symptoms alleviation, and pain relief for the analyzed treatments adjusted by different degrees of withdrawal symptoms before treatment severity.\n\n\n\n\n\n\n\n\n\nTake-home messages\n\n\n\nBased on the evidence synthesized in these analyses, we can establish the following care paths after initial withdrawal symptom severity diagnosis through physical examination, and patient clinical history. Depending on the main outcome of interest to treat, we propose the three most beneficial treatments for each case. When two treatments’ effectiveness were similar, the one with greater adherence rate appears first.\n\nFor patients with no withdrawal symptoms before treatment:\n\nOutcome of interest:\n\nPain: Inpatient BUP, Inpatient NR-NTX, or Outpatient BUP + SMM.\nWithdrawal symptoms: Outpatient BUP + SMM, Methadone, or isolated Outpatient BUP.\n\n\nFor patients with mild withdrawal symptoms before treatment:\n\nOutcome of interest:\n\nPain: Inpatient BUP, Inpatient NR-NTX, or Outpatient BUP + EMM (low effectiveness).\nWithdrawal symptoms: Outpatient BUP + EMM, Outpatient + SMM, or Methadone.\n\n\nFor patients with moderate withdrawal symptoms before treatment:\n\nOutcome of interest:\n\nPain: Inpatient BUP, Inpatient NR-NTX, or Outpatient BUP + EMM (low effectiveness).\nWithdrawal symptoms: Methadone, Outpatient BUP + SMM, or Outpatient BUP + EMM.\n\n\nFor patients with severe withdrawal symptoms before treatment:\n\nOutcome of interest:\n\nPain: Inpatient BUP, Inpatient NR-NTX, or Outpatient BUP + EMM (very low effectiveness).\nWithdrawal symptoms: Methadone, Outpatient BUP + SMM, or Outpatient BUP + EMM.\n\n\n\n\n\n\nsessionInfo()\n\nR version 4.3.2 (2023-10-31)\nPlatform: x86_64-apple-darwin20 (64-bit)\nRunning under: macOS Sonoma 14.3.1\n\nMatrix products: default\nBLAS:   /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib/libRblas.0.dylib \nLAPACK: /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0\n\nlocale:\n[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8\n\ntime zone: Europe/Madrid\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] plotly_4.10.4             DT_0.30                  \n [3] kableExtra_1.3.4          marginaleffects_0.16.0   \n [5] tvthemes_1.3.3            ggsci_3.0.0              \n [7] tidybayes_3.0.6           nnet_7.3-19              \n [9] mgcv_1.9-0                nlme_3.1-163             \n[11] brms_2.20.4               Rcpp_1.0.11              \n[13] ggplot2_3.4.4             tidyr_1.3.0              \n[15] dplyr_1.1.4               public.ctn0094extra_1.0.4\n[17] public.ctn0094data_1.0.6 \n\nloaded via a namespace (and not attached):\n  [1] gridExtra_2.3        inline_0.3.19        rlang_1.1.2         \n  [4] magrittr_2.0.3       matrixStats_1.1.0    compiler_4.3.2      \n  [7] loo_2.6.0            systemfonts_1.0.5    callr_3.7.3         \n [10] vctrs_0.6.5          reshape2_1.4.4       rvest_1.0.3         \n [13] stringr_1.5.1        pkgconfig_2.0.3      arrayhelpers_1.1-0  \n [16] crayon_1.5.2         fastmap_1.1.1        magick_2.8.3        \n [19] backports_1.4.1      ellipsis_0.3.2       labeling_0.4.3      \n [22] utf8_1.2.4           threejs_0.3.3        promises_1.2.1      \n [25] rmarkdown_2.25       markdown_1.11        ps_1.7.5            \n [28] purrr_1.0.2          xfun_0.41            jsonlite_1.8.7      \n [31] highr_0.10           later_1.3.1          parallel_4.3.2      \n [34] prettyunits_1.2.0    R6_2.5.1             dygraphs_1.1.1.6    \n [37] RColorBrewer_1.1-3   stringi_1.8.2        StanHeaders_2.26.28 \n [40] extrafontdb_1.0      rstan_2.32.3         knitr_1.45          \n [43] zoo_1.8-12           base64enc_0.1-3      extrafont_0.19      \n [46] bayesplot_1.10.0     httpuv_1.6.12        Matrix_1.6-1.1      \n [49] splines_4.3.2        igraph_2.0.2         tidyselect_1.2.0    \n [52] rstudioapi_0.15.0    abind_1.4-5          yaml_2.3.7          \n [55] codetools_0.2-19     miniUI_0.1.1.1       processx_3.8.2      \n [58] pkgbuild_1.4.2       lattice_0.21-9       tibble_3.2.1        \n [61] plyr_1.8.9           shiny_1.8.0          withr_2.5.2         \n [64] bridgesampling_1.1-2 posterior_1.5.0      coda_0.19-4         \n [67] evaluate_0.23        RcppParallel_5.1.7   xml2_1.3.5          \n [70] ggdist_3.3.1         xts_0.13.1           pillar_1.9.0        \n [73] tensorA_0.36.2       checkmate_2.3.0      stats4_4.3.2        \n [76] insight_0.19.7       shinyjs_2.1.0        distributional_0.3.2\n [79] generics_0.1.3       rstantools_2.3.1.1   munsell_0.5.0       \n [82] scales_1.3.0         gtools_3.9.5         xtable_1.8-4        \n [85] glue_1.6.2           lazyeval_0.2.2       tools_4.3.2         \n [88] shinystan_2.6.0      data.table_1.14.8    webshot_0.5.5       \n [91] colourpicker_1.3.0   mvtnorm_1.2-4        grid_4.3.2          \n [94] Rttf2pt1_1.3.12      QuickJSR_1.0.8       crosstalk_1.2.1     \n [97] colorspace_2.1-0     cli_3.6.1            fansi_1.0.5         \n[100] svUnit_1.0.6         viridisLite_0.4.2    svglite_2.1.2       \n[103] Brobdingnag_1.2-9    gtable_0.3.4         digest_0.6.33       \n[106] htmlwidgets_1.6.3    farver_2.1.1         htmltools_0.5.7     \n[109] lifecycle_1.0.4      httr_1.4.7           mime_0.12           \n[112] shinythemes_1.2.0"
  }
]